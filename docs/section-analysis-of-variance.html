<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Applied Environmental Statistics</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="A textbook for the use of R in environmental statistics.">
  <meta name="generator" content="bookdown 0.3 and GitBook 2.6.7">

  <meta property="og:title" content="Applied Environmental Statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A textbook for the use of R in environmental statistics." />
  <meta name="github-repo" content="dyerlab/AppliedEnvironmentalStatistics" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Applied Environmental Statistics" />
  
  <meta name="twitter:description" content="A textbook for the use of R in environmental statistics." />
  

<meta name="author" content="Rodney J. Dyer">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="section-linear-regression.html">


<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="media/style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Frontmatter</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#section-typography"><i class="fa fa-check"></i>Typography</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#section-interactive-content"><i class="fa fa-check"></i>Interactive Content</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#section-dedication"><i class="fa fa-check"></i>Dedication</a></li>
</ul></li>
<li class="part"><span><b>I Foundations</b></span></li>
<li class="chapter" data-level="1" data-path="section-the-r-ecosystem.html"><a href="section-the-r-ecosystem.html"><i class="fa fa-check"></i><b>1</b> The R Ecosystem</a><ul>
<li class="chapter" data-level="1.1" data-path="section-the-r-ecosystem.html"><a href="section-the-r-ecosystem.html#section-getting-r-configured"><i class="fa fa-check"></i><b>1.1</b> Getting R Configured</a><ul>
<li class="chapter" data-level="1.1.1" data-path="section-the-r-ecosystem.html"><a href="section-the-r-ecosystem.html#section-packages"><i class="fa fa-check"></i><b>1.1.1</b> Packages</a></li>
<li class="chapter" data-level="1.1.2" data-path="section-the-r-ecosystem.html"><a href="section-the-r-ecosystem.html#section-cran"><i class="fa fa-check"></i><b>1.1.2</b> CRAN</a></li>
<li class="chapter" data-level="1.1.3" data-path="section-the-r-ecosystem.html"><a href="section-the-r-ecosystem.html#section-github"><i class="fa fa-check"></i><b>1.1.3</b> GitHub</a></li>
<li class="chapter" data-level="1.1.4" data-path="section-the-r-ecosystem.html"><a href="section-the-r-ecosystem.html#section-bioconductor"><i class="fa fa-check"></i><b>1.1.4</b> Bioconductor</a></li>
<li class="chapter" data-level="1.1.5" data-path="section-the-r-ecosystem.html"><a href="section-the-r-ecosystem.html#section-troublesome-packages"><i class="fa fa-check"></i><b>1.1.5</b> Troublesome Packages</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="section-the-r-ecosystem.html"><a href="section-the-r-ecosystem.html#section-libraries-used"><i class="fa fa-check"></i><b>1.2</b> Libraries Used</a></li>
<li class="chapter" data-level="1.3" data-path="section-the-r-ecosystem.html"><a href="section-the-r-ecosystem.html#section-the-rstudio-environment"><i class="fa fa-check"></i><b>1.3</b> The RStudio Environment</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="section-data-types.html"><a href="section-data-types.html"><i class="fa fa-check"></i><b>2</b> Data Types</a><ul>
<li class="chapter" data-level="2.1" data-path="section-data-types.html"><a href="section-data-types.html#section-numeric-data-types"><i class="fa fa-check"></i><b>2.1</b> Numeric Data Types</a><ul>
<li class="chapter" data-level="2.1.1" data-path="section-data-types.html"><a href="section-data-types.html#section-coercion-to-numeric"><i class="fa fa-check"></i><b>2.1.1</b> Coercion to Numeric</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="section-data-types.html"><a href="section-data-types.html#section-characters"><i class="fa fa-check"></i><b>2.2</b> Characters</a><ul>
<li class="chapter" data-level="2.2.1" data-path="section-data-types.html"><a href="section-data-types.html#section-concatenation-of-characters"><i class="fa fa-check"></i><b>2.2.1</b> Concatenation of Characters</a></li>
<li class="chapter" data-level="2.2.2" data-path="section-data-types.html"><a href="section-data-types.html#section-coercion-to-characters"><i class="fa fa-check"></i><b>2.2.2</b> Coercion to Characters</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="section-data-types.html"><a href="section-data-types.html#section-factors"><i class="fa fa-check"></i><b>2.3</b> Factors</a><ul>
<li class="chapter" data-level="2.3.1" data-path="section-data-types.html"><a href="section-data-types.html#section-missing-levels-in-factors"><i class="fa fa-check"></i><b>2.3.1</b> Missing Levels in Factors</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="section-data-types.html"><a href="section-data-types.html#section-logical-types"><i class="fa fa-check"></i><b>2.4</b> Logical Types</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="section-data-containers.html"><a href="section-data-containers.html"><i class="fa fa-check"></i><b>3</b> Data Containers</a><ul>
<li class="chapter" data-level="3.1" data-path="section-data-containers.html"><a href="section-data-containers.html#section-vectors"><i class="fa fa-check"></i><b>3.1</b> Vectors</a></li>
<li class="chapter" data-level="3.2" data-path="section-data-containers.html"><a href="section-data-containers.html#section-matrices"><i class="fa fa-check"></i><b>3.2</b> Matrices</a></li>
<li class="chapter" data-level="3.3" data-path="section-data-containers.html"><a href="section-data-containers.html#section-lists"><i class="fa fa-check"></i><b>3.3</b> Lists</a></li>
<li class="chapter" data-level="3.4" data-path="section-data-containers.html"><a href="section-data-containers.html#section-data-frames"><i class="fa fa-check"></i><b>3.4</b> Data Frames</a><ul>
<li class="chapter" data-level="3.4.1" data-path="section-data-containers.html"><a href="section-data-containers.html#section-indexing-data-frames"><i class="fa fa-check"></i><b>3.4.1</b> Indexing Data Frames</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="section-manipulating-data.html"><a href="section-manipulating-data.html"><i class="fa fa-check"></i><b>4</b> Manipulating Data</a><ul>
<li class="chapter" data-level="4.1" data-path="section-manipulating-data.html"><a href="section-manipulating-data.html#section-data-import-export"><i class="fa fa-check"></i><b>4.1</b> Data Import &amp; Export</a></li>
<li class="chapter" data-level="4.2" data-path="section-manipulating-data.html"><a href="section-manipulating-data.html#section-diving-into-data"><i class="fa fa-check"></i><b>4.2</b> Diving Into Data</a></li>
<li class="chapter" data-level="4.3" data-path="section-manipulating-data.html"><a href="section-manipulating-data.html#section-factor-character-data"><i class="fa fa-check"></i><b>4.3</b> Factor &amp; Character Data</a></li>
<li class="chapter" data-level="4.4" data-path="section-manipulating-data.html"><a href="section-manipulating-data.html#section-indexing"><i class="fa fa-check"></i><b>4.4</b> Indexing</a></li>
<li class="chapter" data-level="4.5" data-path="section-manipulating-data.html"><a href="section-manipulating-data.html#section-sorting-ordering"><i class="fa fa-check"></i><b>4.5</b> Sorting &amp; Ordering</a></li>
<li class="chapter" data-level="4.6" data-path="section-manipulating-data.html"><a href="section-manipulating-data.html#section-manipulating-data-1"><i class="fa fa-check"></i><b>4.6</b> Manipulating Data</a></li>
<li class="chapter" data-level="4.7" data-path="section-manipulating-data.html"><a href="section-manipulating-data.html#section-tabulating"><i class="fa fa-check"></i><b>4.7</b> Tabulating</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="section-programming.html"><a href="section-programming.html"><i class="fa fa-check"></i><b>5</b> Programming</a><ul>
<li class="chapter" data-level="5.1" data-path="section-programming.html"><a href="section-programming.html#section-function-writing"><i class="fa fa-check"></i><b>5.1</b> Function Writing</a></li>
<li class="chapter" data-level="5.2" data-path="section-programming.html"><a href="section-programming.html#section-variable-scope"><i class="fa fa-check"></i><b>5.2</b> Variable Scope</a></li>
<li class="chapter" data-level="5.3" data-path="section-programming.html"><a href="section-programming.html#section-decision-making"><i class="fa fa-check"></i><b>5.3</b> Decision Making</a><ul>
<li class="chapter" data-level="5.3.1" data-path="section-programming.html"><a href="section-programming.html#section-the-if-pattern"><i class="fa fa-check"></i><b>5.3.1</b> The if Pattern</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="section-programming.html"><a href="section-programming.html#section-the-if-else-pattern"><i class="fa fa-check"></i><b>5.4</b> The <code>if-else</code> Pattern</a></li>
<li class="chapter" data-level="5.5" data-path="section-programming.html"><a href="section-programming.html#section-flow-control"><i class="fa fa-check"></i><b>5.5</b> Flow Control</a><ul>
<li class="chapter" data-level="5.5.1" data-path="section-programming.html"><a href="section-programming.html#section-the-for-loop"><i class="fa fa-check"></i><b>5.5.1</b> The <code>for()</code> Loop</a></li>
<li class="chapter" data-level="5.5.2" data-path="section-programming.html"><a href="section-programming.html#section-short-circuiting-the-loop"><i class="fa fa-check"></i><b>5.5.2</b> Short Circuiting the Loop</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="section-markdown.html"><a href="section-markdown.html"><i class="fa fa-check"></i><b>6</b> Markdown</a><ul>
<li class="chapter" data-level="6.1" data-path="section-markdown.html"><a href="section-markdown.html#section-markdown-1"><i class="fa fa-check"></i><b>6.1</b> Markdown</a></li>
<li class="chapter" data-level="6.2" data-path="section-markdown.html"><a href="section-markdown.html#section-marking-up-text"><i class="fa fa-check"></i><b>6.2</b> Marking up Text</a></li>
<li class="chapter" data-level="6.3" data-path="section-markdown.html"><a href="section-markdown.html#section-inserting-r-code-chunks"><i class="fa fa-check"></i><b>6.3</b> Inserting R Code Chunks</a><ul>
<li class="chapter" data-level="6.3.1" data-path="section-markdown.html"><a href="section-markdown.html#section-chunk-options"><i class="fa fa-check"></i><b>6.3.1</b> Chunk Options</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="section-markdown.html"><a href="section-markdown.html#section-variables-in-text"><i class="fa fa-check"></i><b>6.4</b> Variables in Text</a></li>
</ul></li>
<li class="part"><span><b>II Data</b></span></li>
<li class="chapter" data-level="7" data-path="section-manipulating-data-2.html"><a href="section-manipulating-data-2.html"><i class="fa fa-check"></i><b>7</b> Manipulating Data</a></li>
<li class="chapter" data-level="8" data-path="section-graphical-display.html"><a href="section-graphical-display.html"><i class="fa fa-check"></i><b>8</b> Graphical Display</a></li>
<li class="chapter" data-level="9" data-path="section-ggplot.html"><a href="section-ggplot.html"><i class="fa fa-check"></i><b>9</b> GGPlot</a></li>
<li class="chapter" data-level="10" data-path="section-spatial-data.html"><a href="section-spatial-data.html"><i class="fa fa-check"></i><b>10</b> Spatial Data</a></li>
<li class="part"><span><b>III Statistical Inferences</b></span></li>
<li class="chapter" data-level="11" data-path="section-summary-statistics.html"><a href="section-summary-statistics.html"><i class="fa fa-check"></i><b>11</b> Summary Statistics</a><ul>
<li class="chapter" data-level="11.1" data-path="section-summary-statistics.html"><a href="section-summary-statistics.html#section-central-tendency"><i class="fa fa-check"></i><b>11.1</b> Central Tendency</a></li>
<li class="chapter" data-level="11.2" data-path="section-summary-statistics.html"><a href="section-summary-statistics.html#section-dispersion"><i class="fa fa-check"></i><b>11.2</b> Dispersion</a></li>
<li class="chapter" data-level="11.3" data-path="section-summary-statistics.html"><a href="section-summary-statistics.html#section-ordination"><i class="fa fa-check"></i><b>11.3</b> Ordination</a></li>
<li class="chapter" data-level="11.4" data-path="section-summary-statistics.html"><a href="section-summary-statistics.html#section-hierarchical-clustering"><i class="fa fa-check"></i><b>11.4</b> Hierarchical Clustering</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="section-correlation.html"><a href="section-correlation.html"><i class="fa fa-check"></i><b>12</b> Correlation</a><ul>
<li class="chapter" data-level="12.1" data-path="section-correlation.html"><a href="section-correlation.html#section-the-data"><i class="fa fa-check"></i><b>12.1</b> The Data</a></li>
<li class="chapter" data-level="12.2" data-path="section-correlation.html"><a href="section-correlation.html#section-parametric-correlations"><i class="fa fa-check"></i><b>12.2</b> Parametric Correlations</a></li>
<li class="chapter" data-level="12.3" data-path="section-correlation.html"><a href="section-correlation.html#section-non-parametric-correlation"><i class="fa fa-check"></i><b>12.3</b> Non-Parametric Correlation</a></li>
<li class="chapter" data-level="12.4" data-path="section-correlation.html"><a href="section-correlation.html#section-differences"><i class="fa fa-check"></i><b>12.4</b> Differences</a></li>
<li class="chapter" data-level="12.5" data-path="section-correlation.html"><a href="section-correlation.html#section-permutation"><i class="fa fa-check"></i><b>12.5</b> Permutation</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="section-linear-regression.html"><a href="section-linear-regression.html"><i class="fa fa-check"></i><b>13</b> Linear Regression</a><ul>
<li class="chapter" data-level="13.1" data-path="section-linear-regression.html"><a href="section-linear-regression.html#section-the-data-1"><i class="fa fa-check"></i><b>13.1</b> The Data</a></li>
<li class="chapter" data-level="13.2" data-path="section-linear-regression.html"><a href="section-linear-regression.html#section-least-squares-linear-regression"><i class="fa fa-check"></i><b>13.2</b> Least Squares Linear Regression</a></li>
<li class="chapter" data-level="13.3" data-path="section-linear-regression.html"><a href="section-linear-regression.html#section-fitting-a-linear-model"><i class="fa fa-check"></i><b>13.3</b> Fitting a Linear Model</a></li>
<li class="chapter" data-level="13.4" data-path="section-linear-regression.html"><a href="section-linear-regression.html#section-multiple-regression"><i class="fa fa-check"></i><b>13.4</b> Multiple Regression</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="section-analysis-of-variance.html"><a href="section-analysis-of-variance.html"><i class="fa fa-check"></i><b>14</b> Analysis of Variance</a><ul>
<li class="chapter" data-level="14.1" data-path="section-analysis-of-variance.html"><a href="section-analysis-of-variance.html#section-one-sample-hypotheses"><i class="fa fa-check"></i><b>14.1</b> One Sample Hypotheses</a><ul>
<li class="chapter" data-level="14.1.1" data-path="section-analysis-of-variance.html"><a href="section-analysis-of-variance.html#section-data-variability"><i class="fa fa-check"></i><b>14.1.1</b> Data Variability</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="section-analysis-of-variance.html"><a href="section-analysis-of-variance.html#section-two-sample-hypotheses"><i class="fa fa-check"></i><b>14.2</b> Two Sample Hypotheses</a></li>
<li class="chapter" data-level="14.3" data-path="section-analysis-of-variance.html"><a href="section-analysis-of-variance.html#section-many-sample-hypotheses"><i class="fa fa-check"></i><b>14.3</b> Many Sample Hypotheses</a><ul>
<li class="chapter" data-level="14.3.1" data-path="section-analysis-of-variance.html"><a href="section-analysis-of-variance.html#section-post-hoc-tests"><i class="fa fa-check"></i><b>14.3.1</b> Post-Hoc Tests</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="http://dyerlab.org" target="blank">the Dyer Laboratory</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Environmental Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="section-analysis-of-variance" class="section level1">
<h1><span class="header-section-number">14</span> Analysis of Variance</h1>
<blockquote>
<p>Here we explore methods applicable to testing hypotheses about specific parameters, as equal to a specified value (a <span class="math inline">\(t\)</span>-test), equal between two samples (paired <span class="math inline">\(t\)</span>-tests), and equal among more than two groups (analysis of variance).</p>
</blockquote>
<p>In this and the next section, we will examine how to tell the difference between measures of central tendency. This is applied to a single set of data, pairs of data sets, and a data set with many different groups. As we increase the complexity of these hypotheses, we will move through a series of statistical tests, starting with a one-sample <span class="math inline">\(t\)</span>-test, a paired <span class="math inline">\(t\)</span>-test, and then to the general analysis of variance (ANVOA) approaches. All of these methods evaluate the equality of mean values.</p>
<div id="section-one-sample-hypotheses" class="section level2">
<h2><span class="header-section-number">14.1</span> One Sample Hypotheses</h2>
<p>At the most basic level, we can take a set of data and test to see if the mean of those values are equated to some particular value, <span class="math inline">\(H_O: \mu = x\)</span> (or <span class="math inline">\(H_O: \mu = 0\)</span> in some cases). The idea here is to determine, by specifying a value for the null hypothesis, what we expect the mean value to be equal to. Going back to our idea of hypothesis testing, the null hypothesis is the thing we are trying to disprove (with some level of statistical confidence) and in doing so we need to define a test statistic that we have an idea about its behavior. In this case, we will define Student’s <span class="math inline">\(t\)</span>-test statistic as:</p>
<p><span class="math display">\[
t =\frac{\bar{x}-\mu}{s_{\bar{x}}}
\]</span></p>
<p>where <span class="math inline">\(\bar{x}\)</span> is the observed mean of the data, <span class="math inline">\(\mu\)</span> is the mean value specified under the null hypothesis, and <span class="math inline">\(s_{\bar{x}}\)</span> is the standard deviation of the data. The value of the <span class="math inline">\(t\)</span>-statistic can be defined based upon the sample size (e.g., the degrees of freedom, <span class="math inline">\(df\)</span>). Here is what the probability density function looks like for <span class="math inline">\(df = (1,3,\infty)\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>( ggplot2 )
x &lt;-<span class="st"> </span><span class="kw">seq</span>(-<span class="dv">5</span>,<span class="dv">5</span>,<span class="dt">by=</span><span class="fl">0.02</span>)
d &lt;-<span class="st"> </span><span class="kw">data.frame</span>( <span class="dt">t=</span><span class="kw">c</span>(x,x,x),
                  <span class="dt">f=</span><span class="kw">c</span>(<span class="kw">dt</span>(x,<span class="dt">df=</span><span class="dv">1</span>),
                      <span class="kw">dt</span>(x,<span class="dt">df=</span><span class="dv">3</span>),
                      <span class="kw">dt</span>(x,<span class="dt">df=</span><span class="ot">Inf</span>)),
                  <span class="dt">df=</span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;1&quot;</span>,<span class="st">&quot;3&quot;</span>,<span class="st">&quot;Inf&quot;</span>),<span class="dt">each=</span><span class="kw">length</span>(x)))

<span class="kw">ggplot</span>( d, <span class="kw">aes</span>(<span class="dt">x=</span>t,<span class="dt">y=</span>f,<span class="dt">color=</span>df)) +<span class="st"> </span><span class="kw">geom_line</span>() </code></pre></div>
<p><img src="Applied_Environmental_Statistics_files/figure-html/unnamed-chunk-225-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>When <span class="math inline">\(df=\infty\)</span> then <span class="math inline">\(PDF(t) = Normal\)</span>. As such, we do not need to make corrections to understand the area under the curve, we can just use the normal probability density function. In fact, when <span class="math inline">\(df=\infty\)</span> then <span class="math inline">\(t_{\alpha,\infty} = Z_{\alpha} = \sqrt{\chi^2_{\alpha,df=1}}\)</span>! The take home message here is that all your statistics become much easier when <span class="math inline">\(N=\infty\)</span>, so go collect some more data!</p>
<p>For <span class="math inline">\(df &lt; \infty\)</span> (all the cases we will be dealing with), we will use the approximation defined by the <span class="math inline">\(t\)</span> distribution. If you look at the distributions above, you see that as we increase the number of samples (e.g., as <span class="math inline">\(df\)</span> increases), the distribution becomes more restricted. The actual function is defined (where <span class="math inline">\(df = v\)</span> for simplicity in nomenclature) as:</p>
<p><span class="math display">\[
P(t|x,v)= \frac{ \Gamma\left( \frac{v+1}{2}\right)}{\sqrt{v\pi}\Gamma\left( \frac{v}{2}\right)} \left( 1 + \frac{x^2}{v}\right)^{-\frac{v+1}{2}}
\]</span></p>
<p>where <span class="math inline">\(\Gamma\)</span> is the Gamma function. Not pretty! Fortunately, we have some built-in facilities in R that can make it easy for us.</p>
<p>For a single set of data, we can use the function above to estimate a value of the <span class="math inline">\(t\)</span> statistic. The probability distribution, defined by the degrees of freedom, identifies regions within which we may suspect the statistic to be abnormally large. In our case, though it is quite arbitrary, we can define either one or two regions of the distribution whose values would be extreme enough such that we would consider a significant deviation. For a two-tailed test, the distribution below illustrates this concept. If the estimated value of the <span class="math inline">\(t\)</span> statistic is in either of the shaded regions, we would reject the null hypothesis of <span class="math inline">\(H_O: \mu = 0\)</span> where <span class="math inline">\(\alpha=0.05\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">t=</span><span class="kw">c</span>( <span class="kw">seq</span>(-<span class="dv">5</span>,-<span class="fl">2.064</span>, <span class="dt">by=</span><span class="fl">0.02</span>), -<span class="fl">2.064</span>, -<span class="dv">5</span>), 
                 <span class="dt">f=</span><span class="kw">c</span>( <span class="kw">dt</span>( <span class="kw">seq</span>(-<span class="dv">5</span>,-<span class="fl">2.064</span>, <span class="dt">by=</span><span class="fl">0.02</span>),<span class="dt">df=</span><span class="dv">1</span>), <span class="fl">0.01224269</span>, <span class="fl">0.01224269</span>))
d2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">t=</span><span class="kw">c</span>( <span class="kw">seq</span>(<span class="fl">2.064</span>,<span class="dv">5</span>,<span class="dt">by=</span><span class="fl">0.02</span>), <span class="dv">5</span>, <span class="fl">2.064</span>),
                 <span class="dt">f=</span><span class="kw">c</span>( <span class="kw">dt</span>( <span class="kw">seq</span>( <span class="fl">2.064</span>, <span class="dv">5</span>, <span class="dt">by=</span><span class="fl">0.02</span>),<span class="dt">df=</span><span class="dv">1</span>), <span class="fl">0.01224269</span>, <span class="fl">0.01224269</span>))
d3 &lt;-<span class="st"> </span><span class="kw">data.frame</span>( <span class="dt">x=</span><span class="kw">c</span>(<span class="fl">2.5</span>,-<span class="fl">2.5</span>), <span class="dt">y=</span><span class="fl">0.02719</span>, <span class="dt">label=</span><span class="st">&quot;2.5%&quot;</span>)
<span class="kw">ggplot</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_polygon</span>(<span class="kw">aes</span>(t,f),<span class="dt">data=</span>d1, <span class="dt">fill=</span><span class="st">&quot;#F8766D&quot;</span>,<span class="dt">alpha=</span><span class="fl">0.5</span>,<span class="dt">color=</span><span class="st">&quot;#F8766D&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_polygon</span>(<span class="kw">aes</span>(t,f),<span class="dt">data=</span>d2, <span class="dt">fill=</span><span class="st">&quot;#F8766D&quot;</span>,<span class="dt">alpha=</span><span class="fl">0.5</span>,<span class="dt">color=</span><span class="st">&quot;#F8766D&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>( <span class="kw">aes</span>(t,f),<span class="dt">data=</span>d[d$df==<span class="dv">1</span>,], <span class="dt">color=</span><span class="st">&quot;#F8766D&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_text</span>( <span class="kw">aes</span>(x,y,<span class="dt">label=</span>label),<span class="dt">data=</span>d3)</code></pre></div>
<p><img src="Applied_Environmental_Statistics_files/figure-html/unnamed-chunk-226-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>In R, we can use the <code>t.test()</code> function. I’m going to go back to the <em>Iris</em> data set and use that as it has three categories (the species) and many measurements on sepals and pedals. Here I separate the species into their own <code>data.frame</code> objects.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df.se &lt;-<span class="st"> </span>iris[ iris$Species ==<span class="st"> &quot;setosa&quot;</span>,] 
df.ve &lt;-<span class="st"> </span>iris[ iris$Species ==<span class="st"> &quot;versicolor&quot;</span>,] 
df.vi &lt;-<span class="st"> </span>iris[ iris$Species ==<span class="st"> &quot;virginica&quot;</span>,]</code></pre></div>
<p>Lets look at the <code>Sepal.Length</code> feature in these species and create some hypotheses about it.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>( iris, <span class="kw">aes</span>(<span class="dt">x=</span>Sepal.Length, <span class="dt">fill=</span>Species)) +<span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">alpha=</span><span class="fl">0.75</span>)</code></pre></div>
<p><img src="Applied_Environmental_Statistics_files/figure-html/unnamed-chunk-228-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>We could test the hypothesis, <span class="math inline">\(H_O: mean(Sepal.Length)=6\)</span> for each of the species.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit.se &lt;-<span class="st"> </span><span class="kw">t.test</span>(df.se$Sepal.Length, <span class="dt">mu =</span> <span class="fl">6.0</span>)
fit.se</code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  df.se$Sepal.Length
## t = -19.94, df = 49, p-value &lt; 2.2e-16
## alternative hypothesis: true mean is not equal to 6
## 95 percent confidence interval:
##  4.905824 5.106176
## sample estimates:
## mean of x 
##     5.006</code></pre>
<p>From the output, it appears that we can reject that null hypothesis (<span class="math inline">\(t =\)</span> -19.9; <span class="math inline">\(df =\)</span> 49; <span class="math inline">\(P =\)</span> 3.7e-25).</p>
<p>For <em>I. versicolor</em>, we see that the mean does appear to be equal to 6.0 (and thus fail to reject the null hypothesis):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>( df.ve$Sepal.Length, <span class="dt">mu=</span><span class="fl">6.0</span> )</code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  df.ve$Sepal.Length
## t = -0.87674, df = 49, p-value = 0.3849
## alternative hypothesis: true mean is not equal to 6
## 95 percent confidence interval:
##  5.789306 6.082694
## sample estimates:
## mean of x 
##     5.936</code></pre>
<p>and for <em>I. virginica</em>, we find that it is significantly larger than 6.0 and again reject the null hypothesis:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>( df.vi$Sepal.Length, <span class="dt">mu=</span><span class="fl">6.0</span> )</code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  df.vi$Sepal.Length
## t = 6.5386, df = 49, p-value = 3.441e-08
## alternative hypothesis: true mean is not equal to 6
## 95 percent confidence interval:
##  6.407285 6.768715
## sample estimates:
## mean of x 
##     6.588</code></pre>
<p>In all the output, we are also given an estimate of the Confidence Interval around the mean. This confidence interval is determined as:</p>
<p><span class="math display">\[
\bar{x} - t_{\alpha, df} s_{\bar{x}} &lt; \mu &lt; \bar{x} + t_{\alpha, df} s_{\bar{x}}
\]</span></p>
<p>or the mean plus or minus standard deviation of the data times the value of the <span class="math inline">\(t\)</span>-statistic for a given level of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(df\)</span>.</p>
<div id="section-data-variability" class="section level3">
<h3><span class="header-section-number">14.1.1</span> Data Variability</h3>
<p>There are times when reporting some confidence around a parameter is important, particularly when using tabular data as output.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Species &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Iris setosa&quot;</span>,<span class="st">&quot;Iris versicolor&quot;</span>,<span class="st">&quot;Iris virginia&quot;</span>)
Sepal.Length &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(df.se$Sepal.Length), <span class="kw">mean</span>(df.ve$Sepal.Length), <span class="kw">mean</span>( df.vi$Sepal.Length))
Sepal.Length.SE &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">sd</span>(df.se$Sepal.Length), <span class="kw">sd</span>(df.ve$Sepal.Length), <span class="kw">sd</span>( df.vi$Sepal.Length))
Sepal.Length.SEM &lt;-<span class="st"> </span>Sepal.Length.SE /<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">50</span>)</code></pre></div>
<p>There are two ways we can talk about the data and it is important for you to think about what you are trying to communicate to your readers. These alternatives include:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sd &lt;-<span class="st"> </span><span class="kw">paste</span>( <span class="kw">format</span>(Sepal.Length,<span class="dt">digits=</span><span class="dv">2</span>), <span class="st">&quot;+/-&quot;</span>, <span class="kw">format</span>(Sepal.Length.SE, <span class="dt">digits=</span><span class="dv">3</span>))
se &lt;-<span class="st"> </span><span class="kw">paste</span>( <span class="kw">format</span>(Sepal.Length,<span class="dt">digits=</span><span class="dv">2</span>), <span class="st">&quot;+/-&quot;</span>, <span class="kw">format</span>(Sepal.Length.SEM, <span class="dt">digits=</span><span class="dv">3</span>))
df &lt;-<span class="st"> </span><span class="kw">data.frame</span>( Species, sd, se )
<span class="kw">names</span>(df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Species&quot;</span>,<span class="st">&quot;Mean +/- SD&quot;</span>, <span class="st">&quot;Sepal Length +/- SE&quot;</span>)
knitr::<span class="kw">kable</span>(df,<span class="dt">row.names =</span> <span class="ot">FALSE</span>,<span class="dt">digits =</span> <span class="dv">3</span>,<span class="dt">align =</span> <span class="st">&quot;lcc&quot;</span>)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Species</th>
<th align="center">Mean +/- SD</th>
<th align="center">Sepal Length +/- SE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Iris setosa</td>
<td align="center">5.0 +/- 0.352</td>
<td align="center">5.0 +/- 0.0498</td>
</tr>
<tr class="even">
<td align="left">Iris versicolor</td>
<td align="center">5.9 +/- 0.516</td>
<td align="center">5.9 +/- 0.0730</td>
</tr>
<tr class="odd">
<td align="left">Iris virginia</td>
<td align="center">6.6 +/- 0.636</td>
<td align="center">6.6 +/- 0.0899</td>
</tr>
</tbody>
</table>
<p>The two columns of data tell us something different. The middle column tells us the mean and the standard deviation of the data. This tells us about the variability (and confidence) of the data itself. The last column is the Standard Error of the Mean (<span class="math inline">\(\frac{s}{\sqrt{N}}\)</span>) and gives us an idea of the confidence we have about the <em>mean</em> estimate of the data (as opposed to the variation of the data itself). These are two different statements about the data and you need to make sure you are confident about which way you want to use to communicate to your audience.</p>
</div>
</div>
<div id="section-two-sample-hypotheses" class="section level2">
<h2><span class="header-section-number">14.2</span> Two Sample Hypotheses</h2>
<p>In addition to a single sample test, evaluating if the mean of a set of data is equal to some specified value, we can test the equality of two different samples. It may be the case that the average sepal length for <em>I. versicolor</em> is not significantly different than 6.0 whereas <em>I. virginia</em> is. However, this does not mean that the mean of both of these species are significantly different from each other. This is a two-sampled hypothesis, stating that <span class="math inline">\(H_O: \mu_X = \mu_Y\)</span>.</p>
<p>Visually, these data look like:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span>iris[ (iris$Species %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;versicolor&quot;</span>,<span class="st">&quot;virginica&quot;</span>)),]
<span class="kw">ggplot</span>( df, <span class="kw">aes</span>(<span class="dt">x=</span>Species, <span class="dt">y=</span>Sepal.Length)) +<span class="st"> </span><span class="kw">geom_boxplot</span>(<span class="dt">notch=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="Applied_Environmental_Statistics_files/figure-html/unnamed-chunk-234-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>which clearly overlap in their distributions but are the mean values different? This sets up the null hypothesis:</p>
<p><span class="math display">\[
H_O: \mu_1 - \mu_2 = 0
\]</span></p>
<p>Under this hypothesis, we can use a <em>t</em>-test like before but just rearranged as:</p>
<p><span class="math display">\[
t = \frac{\bar{x}_1 - \bar{x}_2}{s_{\bar{x}_1-\bar{x}_2}}
\]</span></p>
<p>As before, if the difference in the numerator is small we would reject but here we need to standardize the differences in the means by a measure of the standard deviation that is based upon both sets of data. This is called a the <em>standard error of the difference in two means</em> (real catchy title, no?). This is defined as:</p>
<p><span class="math display">\[
s_{\bar{x}_1-\bar{x}_2} = \sqrt{ \frac{s_1^2}{N_1}+\frac{s_2^2}{N}}
\]</span></p>
<p>To test this, we use the same approach as before but instead of defining <span class="math inline">\(\mu = 6.0\)</span> in the <code>t.test()</code> function, we instead give it both data sets.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>( <span class="dt">x=</span>df.vi$Sepal.Length, <span class="dt">y =</span> df.ve$Sepal.Length )</code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  df.vi$Sepal.Length and df.ve$Sepal.Length
## t = 5.6292, df = 94.025, p-value = 1.866e-07
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  0.4220269 0.8819731
## sample estimates:
## mean of x mean of y 
##     6.588     5.936</code></pre>
<p>Here we get a few bits of new information from the analysis. It is obvious that we would reject the null hypothesis given the magnitude of the estimated <span class="math inline">\(P\)</span>-value. The output also provides us an estimate of the mean values for each group as well as the confidence around the difference in the mean values. This confidence interval does not overlap 0.0, as it shouldn’t if we reject <span class="math inline">\(H_O: \mu_X = \mu_Y\)</span>.</p>
</div>
<div id="section-many-sample-hypotheses" class="section level2">
<h2><span class="header-section-number">14.3</span> Many Sample Hypotheses</h2>
<p>If we have more than two samples, we could do a bunch of paired <span class="math inline">\(t\)</span>-test statistics but this is not the best idea. In fact, if we do this to our data, each time testing at a confidence level of, say, <span class="math inline">\(\alpha = 0.05\)</span>, then for each time we test at <span class="math inline">\(0.05\)</span> but over all pairs, we test at an overall level of <span class="math inline">\(0.05^k\)</span> (where <span class="math inline">\(k\)</span> is the number of tests) value. We cannot do multiple tests without penalizing ourselves in terms of the level at which we consider something significant if we are going to do all these tests. You may have heard about a Bonferroni correction—this does exactly that, it allows us to modify the <span class="math inline">\(\alpha\)</span> level we use to take into consideration the number of tests we are going to use. While this may be an acceptable way to test for the equality of several means (and it may not actually be if you ask most statisticians), there is another way that is much easier.</p>
<p>Consider the case where we have many categories (e.g., factors in R) that we are interested in determining if the mean of all are equal. The null hypothesis for this is, <span class="math inline">\(H_O: \mu_1 = \mu_2 = \ldots = \mu_k\)</span>, where there are <span class="math inline">\(k\)</span> different treatment levels. This is essentially what we’d want to do by doing a bunch of <span class="math inline">\(t\)</span>-tests but we can use another approach that we don’t have to penalize ourselves for multiple tests. Here is how it works.</p>
<p>In the <em>Iris</em> data, we can visualize the means and variation around them by using box plots. Here is an example.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>( iris, <span class="kw">aes</span>(<span class="dt">x=</span>Species, <span class="dt">y=</span>Sepal.Length)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">notch =</span> <span class="ot">TRUE</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Sepal Length&quot;</span>)</code></pre></div>
<p><img src="Applied_Environmental_Statistics_files/figure-html/unnamed-chunk-236-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>For us to tell if there are statistical differences among the species, we need to look at both the location of the mean values as well as the variation around them. We do this by partitioning the variation in all the data into the components within each treatment (species) and among each treatment (species) using an approach derived from the sum of squared deviations (or Sums of Squares). Formally, we can estimate the sum of squares within each of the <span class="math inline">\(K\)</span> groupings as:</p>
<p><span class="math display">\[
SS_{Within} = \sum_{i=1}^K\left( \sum_{j=1}^{N_i}(x_{ij}-\bar{x}_i)^2 \right)
\]</span></p>
<p>whose degrees of freedom are defined as:</p>
<p><span class="math display">\[
df_{W} = \sum_{i=1}^K \left( N_i - 1 \right) = N-K
\]</span></p>
<p>These parameters represent the deviation among samples within groups and the number of independent samples within these groups. We also need to partition out the variation among groups as a similarly defined Sums of Squares:</p>
<p><span class="math display">\[
SS_{Among} = \sum_{i=1}^K N_i\left( \bar{x}_i - \bar{x} \right)^2
\]</span></p>
<p>or the deviation among the mean of each treatment compared to the overall mean of all the data. This parameter has degrees of freedom equal to</p>
<p><span class="math display">\[
df_{A} = K - 1
\]</span></p>
<p>These two parameters describe all the data and as such <span class="math inline">\(SS_{Total} = SS_{Within} + SS_{Among}\)</span>. Formally, we see that</p>
<p><span class="math display">\[
SS_{Total} = \sum_{i=1}^K\sum_{j=1}^{N_i} (x_{ij} - \bar{x})^2
\]</span></p>
<p>whose degrees of freedom are</p>
<p><span class="math display">\[
df_{T} = N - 1
\]</span></p>
<p>For each of these Sums of Squared deviations, we can standardize them using the degrees of freedom. The notion here is that with more samples, and more treatments, we will have greater <span class="math inline">\(SS\)</span> values. However, if we standardize these parameters by the <span class="math inline">\(df\)</span>, we can come up with a standardized Mean Squared values (simplified as <span class="math inline">\(MS = \frac{SS}{df}\)</span> for each level).</p>
<p>If we look at all these values, we can create the venerable ANOVA table with Among, Within, and Total partitions of the variation.</p>
<table>
<colgroup>
<col width="6%" />
<col width="5%" />
<col width="51%" />
<col width="36%" />
</colgroup>
<thead>
<tr class="header">
<th>Source</th>
<th>df</th>
<th>SS</th>
<th>MS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Among</td>
<td><span class="math inline">\(K-1\)</span></td>
<td><span class="math inline">\(\sum_{i=1}^K N_i \left( \bar{x}_i - \bar{x} \right)^2\)</span></td>
<td><span class="math inline">\(\frac{SS_A}{K-1}\)</span></td>
</tr>
<tr class="even">
<td>Within</td>
<td><span class="math inline">\(N-K\)</span></td>
<td><span class="math inline">\(\sum_{i=1}^Kn_i\left( \sum_{j=1}^{N_i}(x_{ij}-\bar{x}_i)^2 \right)\)</span></td>
<td><span class="math inline">\(\frac{SS_W}{N-K}\)</span></td>
</tr>
<tr class="odd">
<td>Total</td>
<td><span class="math inline">\(N-1\)</span></td>
<td><span class="math inline">\(\sum_{i=1}^K \sum_{j=1}^{N_i} (x_{ij} - \bar{x})^2\)</span></td>
<td></td>
</tr>
</tbody>
</table>
<p>In R, we can evaluate the equality of means by partitioning our data as depicted above. Essentially, if at least one of our treatments means deviate significantly, then the <span class="math inline">\(MS_A\)</span> will be abnormally large relative to the variation within each treatment <span class="math inline">\(MS_W\)</span>. This gives us a statistic, defined by the American statistician Snedekor as:</p>
<p><span class="math display">\[
F = \frac{MS_A}{MS_W}
\]</span></p>
<p>as an homage to Ronald Fisher (the F-statistic) has a pretty well understood distribution under a few conditions. This statistic has an expectation of:</p>
<p><span class="math display">\[
f(x | df_A, df_W) = \frac{\sqrt{\frac{(df_Ax)^{df_A}df_W^{df_W}}{(df_Ax + df_W)^{df_W+df_A}}}}{x\mathbf{B}\left( \frac{df_A}{2}, \frac{df_W}{2} \right)}
\]</span></p>
<p>which is even more of a mess than that for the <span class="math inline">\(t\)</span>-test! Luckily, we have a bit of code to do this for us.</p>
<p>Here is an example using the <em>Iris</em> data. Here we test the hypothesis that the Sepal Lengths are all the same (e.g., <span class="math inline">\(H_O: \mu_{se} = \mu_{ve} = \mu_{vi}\)</span>)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit.aov &lt;-<span class="st"> </span><span class="kw">aov</span>( Sepal.Length ~<span class="st"> </span>Species, <span class="dt">data=</span>iris)
fit.aov</code></pre></div>
<pre><code>## Call:
##    aov(formula = Sepal.Length ~ Species, data = iris)
## 
## Terms:
##                  Species Residuals
## Sum of Squares  63.21213  38.95620
## Deg. of Freedom        2       147
## 
## Residual standard error: 0.5147894
## Estimated effects may be unbalanced</code></pre>
<p>The function called here, <code>aov()</code> is the one that does the Analysis of Variance. It returns an object that has the necessary data we need. To estimate the ANOVA table as outlined above we ask for it as:</p>

<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(fit.aov)</code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: Sepal.Length
##            Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## Species     2 63.212  31.606  119.26 &lt; 2.2e-16 ***
## Residuals 147 38.956   0.265                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>which shows that the “Species” treatment are significantly different from each other, with an <span class="math inline">\(F\)</span> statistic equal to <span class="math inline">\(F = 119.3\)</span>, which with 2 and 147 degrees of freedom is assigned a probability equal to <span class="math inline">\(2e^{-16}\)</span>, a very small value!</p>
<div id="section-post-hoc-tests" class="section level3">
<h3><span class="header-section-number">14.3.1</span> Post-Hoc Tests</h3>
<p>What this analysis tells us is that <em>at least</em> one of the treatment means are different from the rest. What it does not tell us is which one or which subset. It could be that <em>I. setosa</em> is significantly smaller than both <em>I. versitosa</em> and <em>I. virginia</em>. It could be that <em>I. virginia</em> is significantly larger than the others, who are not different. It could also mean that they are all different. To address this, we can estimate a <em>post hoc</em> test, to evaluate the difference between treatment means within this model itself.</p>
<p>One of the most common ways to evaluate the equality of treatment mean values is that defined by Tukey. The so-called “Honest Significant Differences” <em>post hoc</em> test is given by</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tuk &lt;-<span class="st"> </span><span class="kw">TukeyHSD</span>(fit.aov)
tuk</code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = Sepal.Length ~ Species, data = iris)
## 
## $Species
##                       diff       lwr       upr p adj
## versicolor-setosa    0.930 0.6862273 1.1737727     0
## virginica-setosa     1.582 1.3382273 1.8257727     0
## virginica-versicolor 0.652 0.4082273 0.8957727     0</code></pre>
<p>which breaks down the pair-wise differences in the mean of each treatment. Here we see the magnitude of the differences in mean values, the lower and upper confidence on the differences, and the probability associated with these differences. In this example, all three comparisons are highly unlikely (e.g., <span class="math inline">\(P\)</span> is very small and in this case essentially zero). As a result, we can interpret these results as suggesting that each of the three species have significantly different. If we plot these results, we see which ones are larger and which are smaller.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>( tuk )</code></pre></div>
<p><img src="Applied_Environmental_Statistics_files/figure-html/unnamed-chunk-240-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Which shows the difference between treatment mean between all pairs of treatments. Overall, we see that the <em>Iris</em> species are all significantly different.</p>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="section-fn1"><p>The word <em>data</em> is plural, datum is singular<a href="section-data-containers.html#section-fnref1">↩</a></p></li>
<li id="section-fn2"><p>I am making this data up, it uses a random number generator and your data is <em>probably</em> not going to produce the same identical correlation but it will be close.<a href="section-correlation.html#section-fnref2">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="section-linear-regression.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>


<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"],
"instapaper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>

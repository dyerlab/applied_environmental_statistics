<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Environmental Data Literacy</title>
  <meta name="description" content="A textbook for the use of R in environmental statistics.">
  <meta name="generator" content="bookdown 0.3.18 and GitBook 2.6.7">

  <meta property="og:title" content="Environmental Data Literacy" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A textbook for the use of R in environmental statistics." />
  <meta name="github-repo" content="dyerlab/applied_environmental_statisics" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Environmental Data Literacy" />
  
  <meta name="twitter:description" content="A textbook for the use of R in environmental statistics." />
  

<meta name="author" content="Rodney J. Dyer">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="statistical-inferences.html">
<link rel="next" href="correlation.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="media/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Frontmatter</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#typography"><i class="fa fa-check"></i>Typography</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#interactive-content"><i class="fa fa-check"></i>Interactive Content</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#dedication"><i class="fa fa-check"></i>Dedication</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-literacy.html"><a href="data-literacy.html"><i class="fa fa-check"></i>Data Literacy</a></li>
<li class="part"><span><b>I Foundations</b></span></li>
<li class="chapter" data-level="1" data-path="the-r-ecosystem.html"><a href="the-r-ecosystem.html"><i class="fa fa-check"></i><b>1</b> The R Ecosystem</a><ul>
<li class="chapter" data-level="1.1" data-path="the-r-ecosystem.html"><a href="the-r-ecosystem.html#getting-r-configured"><i class="fa fa-check"></i><b>1.1</b> Getting R Configured</a><ul>
<li class="chapter" data-level="1.1.1" data-path="the-r-ecosystem.html"><a href="the-r-ecosystem.html#packages"><i class="fa fa-check"></i><b>1.1.1</b> Packages</a></li>
<li class="chapter" data-level="1.1.2" data-path="the-r-ecosystem.html"><a href="the-r-ecosystem.html#cran"><i class="fa fa-check"></i><b>1.1.2</b> CRAN</a></li>
<li class="chapter" data-level="1.1.3" data-path="the-r-ecosystem.html"><a href="the-r-ecosystem.html#github"><i class="fa fa-check"></i><b>1.1.3</b> GitHub</a></li>
<li class="chapter" data-level="1.1.4" data-path="the-r-ecosystem.html"><a href="the-r-ecosystem.html#bioconductor"><i class="fa fa-check"></i><b>1.1.4</b> Bioconductor</a></li>
<li class="chapter" data-level="1.1.5" data-path="the-r-ecosystem.html"><a href="the-r-ecosystem.html#troublesome-packages"><i class="fa fa-check"></i><b>1.1.5</b> Troublesome Packages</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="the-r-ecosystem.html"><a href="the-r-ecosystem.html#libraries-used"><i class="fa fa-check"></i><b>1.2</b> Libraries Used</a></li>
<li class="chapter" data-level="1.3" data-path="the-r-ecosystem.html"><a href="the-r-ecosystem.html#the-rstudio-environment"><i class="fa fa-check"></i><b>1.3</b> The RStudio Environment</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-types.html"><a href="data-types.html"><i class="fa fa-check"></i><b>2</b> Data Types</a><ul>
<li class="chapter" data-level="2.1" data-path="data-types.html"><a href="data-types.html#numeric-data-types"><i class="fa fa-check"></i><b>2.1</b> Numeric Data Types</a></li>
<li class="chapter" data-level="2.2" data-path="data-types.html"><a href="data-types.html#distributions"><i class="fa fa-check"></i><b>2.2</b> Distributions</a><ul>
<li class="chapter" data-level="2.2.1" data-path="data-types.html"><a href="data-types.html#coercion-to-numeric"><i class="fa fa-check"></i><b>2.2.1</b> Coercion to Numeric</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-types.html"><a href="data-types.html#characters"><i class="fa fa-check"></i><b>2.3</b> Characters</a><ul>
<li class="chapter" data-level="2.3.1" data-path="data-types.html"><a href="data-types.html#concatenation-of-characters"><i class="fa fa-check"></i><b>2.3.1</b> Concatenation of Characters</a></li>
<li class="chapter" data-level="2.3.2" data-path="data-types.html"><a href="data-types.html#coercion-to-characters"><i class="fa fa-check"></i><b>2.3.2</b> Coercion to Characters</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-types.html"><a href="data-types.html#factors"><i class="fa fa-check"></i><b>2.4</b> Factors</a><ul>
<li class="chapter" data-level="2.4.1" data-path="data-types.html"><a href="data-types.html#missing-levels-in-factors"><i class="fa fa-check"></i><b>2.4.1</b> Missing Levels in Factors</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="data-types.html"><a href="data-types.html#logical-types"><i class="fa fa-check"></i><b>2.5</b> Logical Types</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-containers.html"><a href="data-containers.html"><i class="fa fa-check"></i><b>3</b> Data Containers</a><ul>
<li class="chapter" data-level="3.1" data-path="data-containers.html"><a href="data-containers.html#vectors"><i class="fa fa-check"></i><b>3.1</b> Vectors</a></li>
<li class="chapter" data-level="3.2" data-path="data-containers.html"><a href="data-containers.html#matrices"><i class="fa fa-check"></i><b>3.2</b> Matrices</a></li>
<li class="chapter" data-level="3.3" data-path="data-containers.html"><a href="data-containers.html#lists"><i class="fa fa-check"></i><b>3.3</b> Lists</a></li>
<li class="chapter" data-level="3.4" data-path="data-containers.html"><a href="data-containers.html#data-frames"><i class="fa fa-check"></i><b>3.4</b> Data Frames</a><ul>
<li class="chapter" data-level="3.4.1" data-path="data-containers.html"><a href="data-containers.html#indexing-data-frames"><i class="fa fa-check"></i><b>3.4.1</b> Indexing Data Frames</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="manipulating-data.html"><a href="manipulating-data.html"><i class="fa fa-check"></i><b>4</b> Manipulating Data</a><ul>
<li class="chapter" data-level="4.1" data-path="manipulating-data.html"><a href="manipulating-data.html#data-import-export"><i class="fa fa-check"></i><b>4.1</b> Data Import &amp; Export</a></li>
<li class="chapter" data-level="4.2" data-path="manipulating-data.html"><a href="manipulating-data.html#diving-into-data"><i class="fa fa-check"></i><b>4.2</b> Diving Into Data</a></li>
<li class="chapter" data-level="4.3" data-path="manipulating-data.html"><a href="manipulating-data.html#factor-character-data"><i class="fa fa-check"></i><b>4.3</b> Factor &amp; Character Data</a></li>
<li class="chapter" data-level="4.4" data-path="manipulating-data.html"><a href="manipulating-data.html#indexing"><i class="fa fa-check"></i><b>4.4</b> Indexing</a></li>
<li class="chapter" data-level="4.5" data-path="manipulating-data.html"><a href="manipulating-data.html#sorting-ordering"><i class="fa fa-check"></i><b>4.5</b> Sorting &amp; Ordering</a></li>
<li class="chapter" data-level="4.6" data-path="manipulating-data.html"><a href="manipulating-data.html#manipulating-data-1"><i class="fa fa-check"></i><b>4.6</b> Manipulating Data</a></li>
<li class="chapter" data-level="4.7" data-path="manipulating-data.html"><a href="manipulating-data.html#tabulating"><i class="fa fa-check"></i><b>4.7</b> Tabulating</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="programming.html"><a href="programming.html"><i class="fa fa-check"></i><b>5</b> Programming</a><ul>
<li class="chapter" data-level="5.1" data-path="programming.html"><a href="programming.html#function-writing"><i class="fa fa-check"></i><b>5.1</b> Function Writing</a></li>
<li class="chapter" data-level="5.2" data-path="programming.html"><a href="programming.html#variable-scope"><i class="fa fa-check"></i><b>5.2</b> Variable Scope</a></li>
<li class="chapter" data-level="5.3" data-path="programming.html"><a href="programming.html#decision-making"><i class="fa fa-check"></i><b>5.3</b> Decision Making</a><ul>
<li class="chapter" data-level="5.3.1" data-path="programming.html"><a href="programming.html#the-if-pattern"><i class="fa fa-check"></i><b>5.3.1</b> The if Pattern</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="programming.html"><a href="programming.html#the-if-else-pattern"><i class="fa fa-check"></i><b>5.4</b> The <code>if-else</code> Pattern</a></li>
<li class="chapter" data-level="5.5" data-path="programming.html"><a href="programming.html#flow-control"><i class="fa fa-check"></i><b>5.5</b> Flow Control</a><ul>
<li class="chapter" data-level="5.5.1" data-path="programming.html"><a href="programming.html#the-for-loop"><i class="fa fa-check"></i><b>5.5.1</b> The <code>for()</code> Loop</a></li>
<li class="chapter" data-level="5.5.2" data-path="programming.html"><a href="programming.html#short-circuiting-the-loop"><i class="fa fa-check"></i><b>5.5.2</b> Short Circuiting the Loop</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="markdown.html"><a href="markdown.html"><i class="fa fa-check"></i><b>6</b> Markdown</a><ul>
<li class="chapter" data-level="6.1" data-path="markdown.html"><a href="markdown.html#markdown-1"><i class="fa fa-check"></i><b>6.1</b> Markdown</a></li>
<li class="chapter" data-level="6.2" data-path="markdown.html"><a href="markdown.html#marking-up-text"><i class="fa fa-check"></i><b>6.2</b> Marking up Text</a></li>
<li class="chapter" data-level="6.3" data-path="markdown.html"><a href="markdown.html#inserting-r-code-chunks"><i class="fa fa-check"></i><b>6.3</b> Inserting R Code Chunks</a><ul>
<li class="chapter" data-level="6.3.1" data-path="markdown.html"><a href="markdown.html#chunk-options"><i class="fa fa-check"></i><b>6.3.1</b> Chunk Options</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="markdown.html"><a href="markdown.html#variables-in-text"><i class="fa fa-check"></i><b>6.4</b> Variables in Text</a></li>
</ul></li>
<li class="part"><span><b>II Data</b></span></li>
<li class="chapter" data-level="7" data-path="manipulating-data-2.html"><a href="manipulating-data-2.html"><i class="fa fa-check"></i><b>7</b> Manipulating Data</a></li>
<li class="chapter" data-level="8" data-path="graphical-display.html"><a href="graphical-display.html"><i class="fa fa-check"></i><b>8</b> Graphical Display</a></li>
<li class="chapter" data-level="9" data-path="ggplot.html"><a href="ggplot.html"><i class="fa fa-check"></i><b>9</b> GGPlot</a></li>
<li class="chapter" data-level="10" data-path="spatial-data.html"><a href="spatial-data.html"><i class="fa fa-check"></i><b>10</b> Spatial Data</a></li>
<li class="part"><span><b>III Statistical Inferences</b></span></li>
<li class="chapter" data-level="11" data-path="statistical-inferences.html"><a href="statistical-inferences.html"><i class="fa fa-check"></i><b>11</b> Statistical Inferences</a><ul>
<li class="chapter" data-level="11.1" data-path="statistical-inferences.html"><a href="statistical-inferences.html#an-applied-example."><i class="fa fa-check"></i><b>11.1</b> An applied example.</a></li>
<li class="chapter" data-level="11.2" data-path="statistical-inferences.html"><a href="statistical-inferences.html#the-binomial"><i class="fa fa-check"></i><b>11.2</b> The Binomial</a></li>
<li class="chapter" data-level="11.3" data-path="statistical-inferences.html"><a href="statistical-inferences.html#a-frequentist-approach"><i class="fa fa-check"></i><b>11.3</b> A Frequentist Approach</a></li>
<li class="chapter" data-level="11.4" data-path="statistical-inferences.html"><a href="statistical-inferences.html#a-bayesian-approach"><i class="fa fa-check"></i><b>11.4</b> A Bayesian Approach</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="summary-statistics.html"><a href="summary-statistics.html"><i class="fa fa-check"></i><b>12</b> Summary Statistics</a><ul>
<li class="chapter" data-level="12.1" data-path="summary-statistics.html"><a href="summary-statistics.html#central-tendency"><i class="fa fa-check"></i><b>12.1</b> Central Tendency</a></li>
<li class="chapter" data-level="12.2" data-path="summary-statistics.html"><a href="summary-statistics.html#dispersion"><i class="fa fa-check"></i><b>12.2</b> Dispersion</a></li>
<li class="chapter" data-level="12.3" data-path="summary-statistics.html"><a href="summary-statistics.html#ordination"><i class="fa fa-check"></i><b>12.3</b> Ordination</a></li>
<li class="chapter" data-level="12.4" data-path="summary-statistics.html"><a href="summary-statistics.html#hierarchical-clustering"><i class="fa fa-check"></i><b>12.4</b> Hierarchical Clustering</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="correlation.html"><a href="correlation.html"><i class="fa fa-check"></i><b>13</b> Correlation</a><ul>
<li class="chapter" data-level="13.1" data-path="correlation.html"><a href="correlation.html#the-data"><i class="fa fa-check"></i><b>13.1</b> The Data</a></li>
<li class="chapter" data-level="13.2" data-path="correlation.html"><a href="correlation.html#parametric-correlations"><i class="fa fa-check"></i><b>13.2</b> Parametric Correlations</a></li>
<li class="chapter" data-level="13.3" data-path="correlation.html"><a href="correlation.html#non-parametric-correlation"><i class="fa fa-check"></i><b>13.3</b> Non-Parametric Correlation</a></li>
<li class="chapter" data-level="13.4" data-path="correlation.html"><a href="correlation.html#differences"><i class="fa fa-check"></i><b>13.4</b> Differences</a></li>
<li class="chapter" data-level="13.5" data-path="correlation.html"><a href="correlation.html#permutation"><i class="fa fa-check"></i><b>13.5</b> Permutation</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>14</b> Linear Regression</a><ul>
<li class="chapter" data-level="14.1" data-path="linear-regression.html"><a href="linear-regression.html#the-data-1"><i class="fa fa-check"></i><b>14.1</b> The Data</a></li>
<li class="chapter" data-level="14.2" data-path="linear-regression.html"><a href="linear-regression.html#least-squares-linear-regression"><i class="fa fa-check"></i><b>14.2</b> Least Squares Linear Regression</a></li>
<li class="chapter" data-level="14.3" data-path="linear-regression.html"><a href="linear-regression.html#fitting-a-linear-model"><i class="fa fa-check"></i><b>14.3</b> Fitting a Linear Model</a></li>
<li class="chapter" data-level="14.4" data-path="linear-regression.html"><a href="linear-regression.html#multiple-regression"><i class="fa fa-check"></i><b>14.4</b> Multiple Regression</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html"><i class="fa fa-check"></i><b>15</b> Analysis of Variance</a><ul>
<li class="chapter" data-level="15.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#one-sample-hypotheses"><i class="fa fa-check"></i><b>15.1</b> One Sample Hypotheses</a><ul>
<li class="chapter" data-level="15.1.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#data-variability"><i class="fa fa-check"></i><b>15.1.1</b> Data Variability</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#two-sample-hypotheses"><i class="fa fa-check"></i><b>15.2</b> Two Sample Hypotheses</a></li>
<li class="chapter" data-level="15.3" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#many-sample-hypotheses"><i class="fa fa-check"></i><b>15.3</b> Many Sample Hypotheses</a><ul>
<li class="chapter" data-level="15.3.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#post-hoc-tests"><i class="fa fa-check"></i><b>15.3.1</b> Post-Hoc Tests</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="http://dyerlab.org" target="blank">the Dyer Laboratory</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Environmental Data Literacy</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="summary-statistics" class="section level1">
<h1><span class="header-section-number">12</span> Summary Statistics</h1>
<blockquote>
<p>In this secion we close out the exploring data section by defining measures of central tendency, dispersion, and explore a few ways to ordinate data.</p>
</blockquote>
<p>For these data, we will use the <code>iris</code> data set as an example. This data set is built into <code>R</code> and is has the quantitative measurements for Sepal Width, Sepal Length, Petal Length, and Petal Width for 150 samples taken from individuals in three different species of <em>Iris</em>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(iris)</code></pre></div>
<pre><code>##   Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   
##  Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  
##  1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300  
##  Median :5.800   Median :3.000   Median :4.350   Median :1.300  
##  Mean   :5.843   Mean   :3.057   Mean   :3.758   Mean   :1.199  
##  3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  
##  Max.   :7.900   Max.   :4.400   Max.   :6.900   Max.   :2.500  
##        Species  
##  setosa    :50  
##  versicolor:50  
##  virginica :50  
##                 
##                 
## </code></pre>
<div id="central-tendency" class="section level2">
<h2><span class="header-section-number">12.1</span> Central Tendency</h2>
<p>Central tendency is a term we use to define the <em>center of gravity</em> of some data. There are several measures of central tendency that we commonly use. In <code>R</code>, only the arithmetic mean is included by default, to estimate the remaining ones, we can install the <code>DescTools</code> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;DescTools&quot;</span>)</code></pre></div>
<p>Once installed, we need to load it into memory.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(DescTools)</code></pre></div>
<p>and we are ready to go.</p>
<p><em>Arithmetic Mean</em> - The arithmetic mean is the ‘average’ that we use on the common vernacular and is defined as:</p>
<p><span class="math display">\[
\mu = \frac{1}{N} \sum_{i=1}^N x_i
\]</span></p>
<p>In <code>R</code> we estimate it using the <code>mean()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>( iris$Sepal.Width )</code></pre></div>
<pre><code>## [1] 3.057333</code></pre>
<p>We can apply this across groupings in our data using the <code>by()</code> function (as we’ve done previously) to measure the mean of measurements across groups of observations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">by</span>( iris$Sepal.Width, iris$Species, mean )</code></pre></div>
<pre><code>## iris$Species: setosa
## [1] 3.428
## -------------------------------------------------------- 
## iris$Species: versicolor
## [1] 2.77
## -------------------------------------------------------- 
## iris$Species: virginica
## [1] 2.974</code></pre>
<p><em>Geometric Mean</em> - The arithmetic mean is not the only way to measure the center of gravity of your data. The geometric mean is defined as the <span class="math inline">\(n^{th}\)</span> root of the product of measurements.</p>
<p><span class="math display">\[
\mu_{g} = \left( \prod_{i=1}^N x_i \right)^{\frac{1}{N}}
\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(DescTools)
<span class="kw">Gmean</span>(iris$Sepal.Width )</code></pre></div>
<pre><code>## [1] 3.026598</code></pre>
<p>The geometric mean is often used to compare values that are multiples or exponential. For example, in the <em>Iris</em> data, it may be more appropriate to evaluate differences in sepal area using the geometric mean rather than the arithmetic one.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">by</span>( iris$Sepal.Width*iris$Sepal.Length, iris$Species, Gmean )</code></pre></div>
<pre><code>## iris$Species: setosa
## [1] 17.01442
## -------------------------------------------------------- 
## iris$Species: versicolor
## [1] 16.27452
## -------------------------------------------------------- 
## iris$Species: virginica
## [1] 19.39149</code></pre>
<p><em>Harmonic Mean</em> - The harmonic mean is an approach commonly applied to fractional data (percentages) or data that has outliers. It is estimated as the recipricol of the arithmetic mean of reciprocals…</p>
<p><span class="math display">\[
\mu_{h} = \frac{1}{\frac{1}{N} \left( \frac{1}{x_1} + \frac{1}{x_2} + \cdots + \frac{1}{x_N} \right)}
\]</span></p>
<p>The effects of outliers can be seen in the example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">100</span>)
<span class="kw">mean</span>(x)</code></pre></div>
<pre><code>## [1] 23.2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Hmean</span>(x)</code></pre></div>
<pre><code>## [1] 4.132231</code></pre>
<p>In our iris data, we can apply the <code>Hmean</code> as before across species</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">by</span>( iris$Sepal.Width, iris$Species, Hmean )</code></pre></div>
<pre><code>## iris$Species: setosa
## [1] 3.385537
## -------------------------------------------------------- 
## iris$Species: versicolor
## [1] 2.733011
## -------------------------------------------------------- 
## iris$Species: virginica
## [1] 2.940087</code></pre>
<p><em>Median</em> - The median is the center of the data, the value where half of the observations are larger and half are smaller—the 50<span class="math inline">\(^{th}\)</span> quantile.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">median</span>( iris$Sepal.Width )</code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">by</span>( iris$Sepal.Width, iris$Species, median )</code></pre></div>
<pre><code>## iris$Species: setosa
## [1] 3.4
## -------------------------------------------------------- 
## iris$Species: versicolor
## [1] 2.8
## -------------------------------------------------------- 
## iris$Species: virginica
## [1] 3</code></pre>
<p>This is a rank-based measure of central tendency and one that we saw in the Normality discussion last week.</p>
</div>
<div id="dispersion" class="section level2">
<h2><span class="header-section-number">12.2</span> Dispersion</h2>
<p>In addition to the central tendency, for us to describe the data, we also need to know a bit about the dispersion of values around the center of gravity.</p>
<p><em>Range</em> - The range is the physical separation between the smallest and largest values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">range</span>( iris$Sepal.Width )</code></pre></div>
<pre><code>## [1] 2.0 4.4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">by</span>( iris$Sepal.Width, iris$Species, range )</code></pre></div>
<pre><code>## iris$Species: setosa
## [1] 2.3 4.4
## -------------------------------------------------------- 
## iris$Species: versicolor
## [1] 2.0 3.4
## -------------------------------------------------------- 
## iris$Species: virginica
## [1] 2.2 3.8</code></pre>
<p>It is identical to:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">c</span>( <span class="kw">min</span>(iris$Sepal.Width), <span class="kw">max</span>( iris$Sepal.Width))</code></pre></div>
<pre><code>## [1] 2.0 4.4</code></pre>
<p><em>Sample Variance</em> - The variance of the data, <span class="math inline">\(\sigma^2\)</span>, is defined as the average distance between the observations and the arithmetic mean of the observations. It is not quite the ‘average’ since we need to punish ourselves for estimation the mean as we’ve lost a <em>degree of freedom</em>. We will come back to this later in a more detailed way, just take it on faith right now. The idealized formula is:</p>
<p><span class="math display">\[
s^2 = \frac{1}{N-1}\sum_{i=1}^N (x_i - \mu)^2
\]</span></p>
<p>which you should never use when using a computer to estimate the sample variance. There are some significant problems with round-off error that cause this theoretical formula to produce incorrect results.</p>
<p>In <code>R</code> we estimate the variance as:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">var</span>( iris$Sepal.Width )</code></pre></div>
<pre><code>## [1] 0.1899794</code></pre>
<p>and can be applied across groups as:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">by</span>( iris$Sepal.Width, iris$Species, var)</code></pre></div>
<pre><code>## iris$Species: setosa
## [1] 0.1436898
## -------------------------------------------------------- 
## iris$Species: versicolor
## [1] 0.09846939
## -------------------------------------------------------- 
## iris$Species: virginica
## [1] 0.1040041</code></pre>
<p>where we can see that <em>I. setosa</em> has more variation in sepal width than the other species.</p>
<p><em>Standard Deviation</em> - The units on the variance are not same as the units for the original data, since it is the deviance squared. To interpret the dispersion in a way that is comparable, we take the square root of the variance - a term called the standard deviation. And while it has its own formula</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sd</span>( iris$Sepal.Width)</code></pre></div>
<pre><code>## [1] 0.4358663</code></pre>
<p>it is identical to</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sqrt</span>( <span class="kw">var</span>( iris$Sepal.Width))</code></pre></div>
<pre><code>## [1] 0.4358663</code></pre>
<p>It is common to use the standard deviation to designate some spread of the data around the mean using error bars. Here is an example using the <code>barplot()</code> and <code>arrows()</code> functions (<em>n.b.</em> I return the value of the x-coordinates from the bar plot function to use in the arrows function).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mu &lt;-<span class="st"> </span><span class="kw">by</span>( iris$Sepal.Width, iris$Species, mean )
b &lt;-<span class="st"> </span><span class="kw">barplot</span>(mu, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">4</span>))
sepal.sd &lt;-<span class="st"> </span><span class="kw">by</span>( iris$Sepal.Width, iris$Species, sd )
x &lt;-<span class="st"> </span>b
y0 &lt;-<span class="st"> </span><span class="kw">as.numeric</span>( mu )
y1 &lt;-<span class="st"> </span>y0 +<span class="st"> </span><span class="kw">as.numeric</span>( sepal.sd)
<span class="kw">arrows</span>( x,y0,x,y1, <span class="dt">angle =</span> <span class="dv">90</span> )</code></pre></div>
<p><img src="Environmental_Data_Literacy_files/figure-html/unnamed-chunk-190-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="ordination" class="section level2">
<h2><span class="header-section-number">12.3</span> Ordination</h2>
<p>There is a group of routines that are used to visualize and reformat data called “ordination.” These approaches are not necessarily analyses, they are more commonly used to understand the underlying data or to reduce the dimensionality of multivariate data.</p>
<p>In this section, we are going to explore a bit about principal component (PC) rotation. A PC rotation is one that takes the original columns of data and performs a rotation on the values to align onto new ‘synthetic’ axes. Consider the example in the next figure. Here, some bivariate data is plot in 2-space, though this can be done for much higher dimensions of data as well—in fact it is more beneficial with more columns of data and this can be used as a way of reducing the dimensionality of the data while loosing very little (or no) content. The axes of a PC rotation are taken as linear combinations of the existing axes and define a new coordinate set onto which the points are plot. All points are rigidly constrained to keep the same relationship and there is no loss of information. The PC axes are defined by determining the most variable stretch through the data. In the figure, we see the raw data plot onto the X- and Y-axes. The axis of highest variance does not align with either of the original ones, and instead can be defined as a combination of both X- and Y- coordinates.</p>
<p><img src="PCA.png" style="display: block; margin: auto;" /></p>
<p>If we take the blue axis as the first PC axis, the coordinate of the points would be taken along that new synthetic axis. The next PC axis is defined as being perpendicular to the previous one(s) and is identified as covering the largest variance in the data as before. This process continues until there are no more axes. In our case, the second axis would be at a right angle from the blue line (above). You can, at maximum, have as many PC axes as there are columns of data. However, the later axes may not explain significant portions of the underlying data, the process of rotating based upon axes of maximal variation may be able to capture the complete data set with fewer axes than the total set. This is where a technique like this may be helpful in reducing the dimensionality of the data as well as finding the ‘big trends’ that may exist in the data set.</p>
<p>To perform this rotation on the <em>iris</em> data, we use the <code>princomp()</code> function. Here we focus only on the numerical data (of course) as the <code>factor</code> is not something we can do this kind of rotation with.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit.pca &lt;-<span class="st"> </span><span class="kw">princomp</span>(iris[,<span class="dv">1</span>:<span class="dv">4</span>], <span class="dt">cor =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>Here are the first 8 (out of 50 potential) axes for the arapat data set.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(fit.pca)</code></pre></div>
<pre><code>## Importance of components:
##                           Comp.1    Comp.2     Comp.3      Comp.4
## Standard deviation     1.7083611 0.9560494 0.38308860 0.143926497
## Proportion of Variance 0.7296245 0.2285076 0.03668922 0.005178709
## Cumulative Proportion  0.7296245 0.9581321 0.99482129 1.000000000</code></pre>
<p>This output has two important components to it. First, it shows the axes, in decreasing order of importance and how much of the total variation they describe. The first Comp.1 axis explains 72.9% of the variance, the second explains 22.8%, etc. Second, it shows the cumulative proportion of the variation explained. From the 4 axes we started with, we can explain 95.8% of the variance by using just the first two PC axes.</p>
<p>Where this becomes meaningful for us is in how we can project our original data onto these new coordinate locations and look at the distribution to see if there are any obvious trends, partitions, gradients, etc.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
pred &lt;-<span class="st"> </span><span class="kw">predict</span>(fit.pca)
df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">PC1 =</span> pred[, <span class="dv">1</span>], <span class="dt">PC2 =</span> pred[, <span class="dv">2</span>])
df$Species &lt;-<span class="st"> </span>iris$Species
<span class="kw">ggplot</span>(df) +<span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> PC1, <span class="dt">y =</span> PC2, <span class="dt">color =</span> Species), <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">alpha =</span> <span class="fl">0.75</span>)</code></pre></div>
<p><img src="Environmental_Data_Literacy_files/figure-html/unnamed-chunk-194-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>We can see from the plot that the the samples are clustered in an obvious way. The designation of ‘Species’ as depicted by the color of the points, shows definite partitions between <em>I. setosa</em> and the remaining species (along the PC1 axis). However, projected onto the PC2 axis, there does not seem to be a partitioning of the samples differentiating the species in an obvious way.</p>
</div>
<div id="hierarchical-clustering" class="section level2">
<h2><span class="header-section-number">12.4</span> Hierarchical Clustering</h2>
<p>In the previous section, we defined a new coordinate space for all samples in the data set. The rotation of the data was able to describe over 95% of the observed variation using only the first two PC axes. In this section, we are going to use the rotated coordinates to evaluate species-level differences using a hierarchical clustering method. Hierarchical clustering are very helpful in understanding groupings in the data, particularly if there is a ‘nesting’ structure. While there are many ways to do it, they all generally proceed as follows:<br />
1. Define a numeric metric that measured the distances between all K groups.<br />
2. Find the two groups that have the smallest distance and coalesce them together into a pair.<br />
3. Assume that the coalesced pair now constitutes a single entity, estimate the numeric metric among all K-1 groups in the data set.<br />
4. Go to #2 and repeat until you have coalesced all the groups together.</p>
<p>Here again, it is the data that is telling us how it is structured rather than us imposing a model onto the data to see if it fits.</p>
<p>To perform a clustering, we first need to start with a distance matrix based upon the original data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris.dist &lt;-<span class="st"> </span><span class="kw">dist</span>( iris[,<span class="dv">1</span>:<span class="dv">4</span>] )</code></pre></div>
<p>We can then perform the above algorithm using the <code>hclust()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">h &lt;-<span class="st"> </span><span class="kw">hclust</span>( iris.dist )
<span class="kw">plot</span>( h )</code></pre></div>
<p><img src="Environmental_Data_Literacy_files/figure-html/unnamed-chunk-196-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Which shows a deep separation between groups. Lets see if we can get a bit more interpretive power out of it by changing the labels to show species:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">h$labels &lt;-<span class="st"> </span>iris$Species 
<span class="kw">plot</span>( h , <span class="dt">cex=</span><span class="fl">0.5</span>)</code></pre></div>
<p><img src="Environmental_Data_Literacy_files/figure-html/unnamed-chunk-197-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>You may need to ‘zoom’ that one a bit to understand the labels because I reduced their font size (the <code>cex</code> bit in the plot statement). This is interesting but would be helpful if we could provide a bit of color to the plot to differentiate the <code>Species</code>. Unfortunately, we cannot just add <code>col=Species</code> (for reasons I don’t quite understand) to the plot but there is a way to change the <code>h</code> object into one that can be colored. However, you <strong>must</strong> first install a new library if you don’t already have it, which I am guessing if this is the first time you’ve done some work using trees in R you have not. Install it in the normal fashion</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;dendextend&quot;</span>)</code></pre></div>
<p>Then we can use it like</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>( dendextend )
d &lt;-<span class="st"> </span><span class="kw">as.dendrogram</span>( h )
<span class="kw">labels_colors</span>( d ) &lt;-<span class="st"> </span><span class="kw">as.numeric</span>( iris$Species )
<span class="kw">plot</span>( d )</code></pre></div>
<p><img src="Environmental_Data_Literacy_files/figure-html/unnamed-chunk-199-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>There are some interesting things to notice here.<br />
- The green <em>setosa</em> group seems to be nicely separated from the rest, just like we saw in the PC plot. - There are some individual samples that are a bit mixed, the <em>I. virginica</em> and <em>I. versicolor</em> samples are mixed together not forming a coherent group.</p>
<p>These plot suggest that morphology along may be a good indicator of species differences for <em>I. setosa</em> but not perhaps that good for telling the differences between the <em>I. virginica</em> and <em>I. versicolor</em> samples.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="statistical-inferences.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="correlation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"],
"instapaper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>

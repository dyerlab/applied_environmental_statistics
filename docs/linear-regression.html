<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Applied Environmental Statistics</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="A textbook for the use of R in environmental statistics.">
  <meta name="generator" content="bookdown 0.3 and GitBook 2.6.7">

  <meta property="og:title" content="Applied Environmental Statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A textbook for the use of R in environmental statistics." />
  <meta name="github-repo" content="dyerlab/AppliedEnvironmentalStatistics" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Applied Environmental Statistics" />
  
  <meta name="twitter:description" content="A textbook for the use of R in environmental statistics." />
  

<meta name="author" content="Rodney J. Dyer">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="correlation.html">
<link rel="next" href="analysis-of-variance.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="media/style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Frontmatter</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#typography"><i class="fa fa-check"></i>Typography</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#interactive-content"><i class="fa fa-check"></i>Interactive Content</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#dedication"><i class="fa fa-check"></i>Dedication</a></li>
</ul></li>
<li class="part"><span><b>I Foundations</b></span></li>
<li class="chapter" data-level="1" data-path="the-r-ecosystem.html"><a href="the-r-ecosystem.html"><i class="fa fa-check"></i><b>1</b> The R Ecosystem</a><ul>
<li class="chapter" data-level="1.1" data-path="the-r-ecosystem.html"><a href="the-r-ecosystem.html#getting-r-configured"><i class="fa fa-check"></i><b>1.1</b> Getting R Configured</a><ul>
<li class="chapter" data-level="1.1.1" data-path="the-r-ecosystem.html"><a href="the-r-ecosystem.html#packages"><i class="fa fa-check"></i><b>1.1.1</b> Packages</a></li>
<li class="chapter" data-level="1.1.2" data-path="the-r-ecosystem.html"><a href="the-r-ecosystem.html#cran"><i class="fa fa-check"></i><b>1.1.2</b> CRAN</a></li>
<li class="chapter" data-level="1.1.3" data-path="the-r-ecosystem.html"><a href="the-r-ecosystem.html#github"><i class="fa fa-check"></i><b>1.1.3</b> GitHub</a></li>
<li class="chapter" data-level="1.1.4" data-path="the-r-ecosystem.html"><a href="the-r-ecosystem.html#bioconductor"><i class="fa fa-check"></i><b>1.1.4</b> Bioconductor</a></li>
<li class="chapter" data-level="1.1.5" data-path="the-r-ecosystem.html"><a href="the-r-ecosystem.html#troublesome-packages"><i class="fa fa-check"></i><b>1.1.5</b> Troublesome Packages</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="the-r-ecosystem.html"><a href="the-r-ecosystem.html#libraries-used"><i class="fa fa-check"></i><b>1.2</b> Libraries Used</a></li>
<li class="chapter" data-level="1.3" data-path="the-r-ecosystem.html"><a href="the-r-ecosystem.html#the-rstudio-environment"><i class="fa fa-check"></i><b>1.3</b> The RStudio Environment</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-types.html"><a href="data-types.html"><i class="fa fa-check"></i><b>2</b> Data Types</a><ul>
<li class="chapter" data-level="2.1" data-path="data-types.html"><a href="data-types.html#numeric-data-types"><i class="fa fa-check"></i><b>2.1</b> Numeric Data Types</a><ul>
<li class="chapter" data-level="2.1.1" data-path="data-types.html"><a href="data-types.html#coercion-to-numeric"><i class="fa fa-check"></i><b>2.1.1</b> Coercion to Numeric</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="data-types.html"><a href="data-types.html#characters"><i class="fa fa-check"></i><b>2.2</b> Characters</a><ul>
<li class="chapter" data-level="2.2.1" data-path="data-types.html"><a href="data-types.html#concatenation-of-characters"><i class="fa fa-check"></i><b>2.2.1</b> Concatenation of Characters</a></li>
<li class="chapter" data-level="2.2.2" data-path="data-types.html"><a href="data-types.html#coercion-to-characters"><i class="fa fa-check"></i><b>2.2.2</b> Coercion to Characters</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-types.html"><a href="data-types.html#factors"><i class="fa fa-check"></i><b>2.3</b> Factors</a><ul>
<li class="chapter" data-level="2.3.1" data-path="data-types.html"><a href="data-types.html#missing-levels-in-factors"><i class="fa fa-check"></i><b>2.3.1</b> Missing Levels in Factors</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-types.html"><a href="data-types.html#logical-types"><i class="fa fa-check"></i><b>2.4</b> Logical Types</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-containers.html"><a href="data-containers.html"><i class="fa fa-check"></i><b>3</b> Data Containers</a><ul>
<li class="chapter" data-level="3.1" data-path="data-containers.html"><a href="data-containers.html#vectors"><i class="fa fa-check"></i><b>3.1</b> Vectors</a></li>
<li class="chapter" data-level="3.2" data-path="data-containers.html"><a href="data-containers.html#matrices"><i class="fa fa-check"></i><b>3.2</b> Matrices</a></li>
<li class="chapter" data-level="3.3" data-path="data-containers.html"><a href="data-containers.html#lists"><i class="fa fa-check"></i><b>3.3</b> Lists</a></li>
<li class="chapter" data-level="3.4" data-path="data-containers.html"><a href="data-containers.html#data-frames"><i class="fa fa-check"></i><b>3.4</b> Data Frames</a><ul>
<li class="chapter" data-level="3.4.1" data-path="data-containers.html"><a href="data-containers.html#indexing-data-frames"><i class="fa fa-check"></i><b>3.4.1</b> Indexing Data Frames</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="manipulating-data.html"><a href="manipulating-data.html"><i class="fa fa-check"></i><b>4</b> Manipulating Data</a><ul>
<li class="chapter" data-level="4.1" data-path="manipulating-data.html"><a href="manipulating-data.html#data-import-export"><i class="fa fa-check"></i><b>4.1</b> Data Import &amp; Export</a></li>
<li class="chapter" data-level="4.2" data-path="manipulating-data.html"><a href="manipulating-data.html#diving-into-data"><i class="fa fa-check"></i><b>4.2</b> Diving Into Data</a></li>
<li class="chapter" data-level="4.3" data-path="manipulating-data.html"><a href="manipulating-data.html#factor-character-data"><i class="fa fa-check"></i><b>4.3</b> Factor &amp; Character Data</a></li>
<li class="chapter" data-level="4.4" data-path="manipulating-data.html"><a href="manipulating-data.html#indexing"><i class="fa fa-check"></i><b>4.4</b> Indexing</a></li>
<li class="chapter" data-level="4.5" data-path="manipulating-data.html"><a href="manipulating-data.html#sorting-ordering"><i class="fa fa-check"></i><b>4.5</b> Sorting &amp; Ordering</a></li>
<li class="chapter" data-level="4.6" data-path="manipulating-data.html"><a href="manipulating-data.html#manipulating-data-1"><i class="fa fa-check"></i><b>4.6</b> Manipulating Data</a></li>
<li class="chapter" data-level="4.7" data-path="manipulating-data.html"><a href="manipulating-data.html#tabulating"><i class="fa fa-check"></i><b>4.7</b> Tabulating</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="programming.html"><a href="programming.html"><i class="fa fa-check"></i><b>5</b> Programming</a><ul>
<li class="chapter" data-level="5.1" data-path="programming.html"><a href="programming.html#function-writing"><i class="fa fa-check"></i><b>5.1</b> Function Writing</a></li>
<li class="chapter" data-level="5.2" data-path="programming.html"><a href="programming.html#variable-scope"><i class="fa fa-check"></i><b>5.2</b> Variable Scope</a></li>
<li class="chapter" data-level="5.3" data-path="programming.html"><a href="programming.html#decision-making"><i class="fa fa-check"></i><b>5.3</b> Decision Making</a><ul>
<li class="chapter" data-level="5.3.1" data-path="programming.html"><a href="programming.html#the-if-pattern"><i class="fa fa-check"></i><b>5.3.1</b> The if Pattern</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="programming.html"><a href="programming.html#the-if-else-pattern"><i class="fa fa-check"></i><b>5.4</b> The <code>if-else</code> Pattern</a></li>
<li class="chapter" data-level="5.5" data-path="programming.html"><a href="programming.html#flow-control"><i class="fa fa-check"></i><b>5.5</b> Flow Control</a><ul>
<li class="chapter" data-level="5.5.1" data-path="programming.html"><a href="programming.html#the-for-loop"><i class="fa fa-check"></i><b>5.5.1</b> The <code>for()</code> Loop</a></li>
<li class="chapter" data-level="5.5.2" data-path="programming.html"><a href="programming.html#short-circuiting-the-loop"><i class="fa fa-check"></i><b>5.5.2</b> Short Circuiting the Loop</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="markdown.html"><a href="markdown.html"><i class="fa fa-check"></i><b>6</b> Markdown</a><ul>
<li class="chapter" data-level="6.1" data-path="markdown.html"><a href="markdown.html#markdown-1"><i class="fa fa-check"></i><b>6.1</b> Markdown</a></li>
<li class="chapter" data-level="6.2" data-path="markdown.html"><a href="markdown.html#marking-up-text"><i class="fa fa-check"></i><b>6.2</b> Marking up Text</a></li>
<li class="chapter" data-level="6.3" data-path="markdown.html"><a href="markdown.html#inserting-r-code-chunks"><i class="fa fa-check"></i><b>6.3</b> Inserting R Code Chunks</a><ul>
<li class="chapter" data-level="6.3.1" data-path="markdown.html"><a href="markdown.html#chunk-options"><i class="fa fa-check"></i><b>6.3.1</b> Chunk Options</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="markdown.html"><a href="markdown.html#variables-in-text"><i class="fa fa-check"></i><b>6.4</b> Variables in Text</a></li>
</ul></li>
<li class="part"><span><b>II Data</b></span></li>
<li class="chapter" data-level="7" data-path="manipulating-data-2.html"><a href="manipulating-data-2.html"><i class="fa fa-check"></i><b>7</b> Manipulating Data</a></li>
<li class="chapter" data-level="8" data-path="graphical-display.html"><a href="graphical-display.html"><i class="fa fa-check"></i><b>8</b> Graphical Display</a></li>
<li class="chapter" data-level="9" data-path="ggplot.html"><a href="ggplot.html"><i class="fa fa-check"></i><b>9</b> GGPlot</a></li>
<li class="chapter" data-level="10" data-path="spatial-data.html"><a href="spatial-data.html"><i class="fa fa-check"></i><b>10</b> Spatial Data</a></li>
<li class="part"><span><b>III Statistical Inferences</b></span></li>
<li class="chapter" data-level="11" data-path="summary-statistics.html"><a href="summary-statistics.html"><i class="fa fa-check"></i><b>11</b> Summary Statistics</a><ul>
<li class="chapter" data-level="11.1" data-path="summary-statistics.html"><a href="summary-statistics.html#central-tendency"><i class="fa fa-check"></i><b>11.1</b> Central Tendency</a></li>
<li class="chapter" data-level="11.2" data-path="summary-statistics.html"><a href="summary-statistics.html#dispersion"><i class="fa fa-check"></i><b>11.2</b> Dispersion</a></li>
<li class="chapter" data-level="11.3" data-path="summary-statistics.html"><a href="summary-statistics.html#ordination"><i class="fa fa-check"></i><b>11.3</b> Ordination</a></li>
<li class="chapter" data-level="11.4" data-path="summary-statistics.html"><a href="summary-statistics.html#hierarchical-clustering"><i class="fa fa-check"></i><b>11.4</b> Hierarchical Clustering</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="correlation.html"><a href="correlation.html"><i class="fa fa-check"></i><b>12</b> Correlation</a><ul>
<li class="chapter" data-level="12.1" data-path="correlation.html"><a href="correlation.html#the-data"><i class="fa fa-check"></i><b>12.1</b> The Data</a></li>
<li class="chapter" data-level="12.2" data-path="correlation.html"><a href="correlation.html#parametric-correlations"><i class="fa fa-check"></i><b>12.2</b> Parametric Correlations</a></li>
<li class="chapter" data-level="12.3" data-path="correlation.html"><a href="correlation.html#non-parametric-correlation"><i class="fa fa-check"></i><b>12.3</b> Non-Parametric Correlation</a></li>
<li class="chapter" data-level="12.4" data-path="correlation.html"><a href="correlation.html#differences"><i class="fa fa-check"></i><b>12.4</b> Differences</a></li>
<li class="chapter" data-level="12.5" data-path="correlation.html"><a href="correlation.html#permutation"><i class="fa fa-check"></i><b>12.5</b> Permutation</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>13</b> Linear Regression</a><ul>
<li class="chapter" data-level="13.1" data-path="linear-regression.html"><a href="linear-regression.html#the-data-1"><i class="fa fa-check"></i><b>13.1</b> The Data</a></li>
<li class="chapter" data-level="13.2" data-path="linear-regression.html"><a href="linear-regression.html#least-squares-linear-regression"><i class="fa fa-check"></i><b>13.2</b> Least Squares Linear Regression</a></li>
<li class="chapter" data-level="13.3" data-path="linear-regression.html"><a href="linear-regression.html#fitting-a-linear-model"><i class="fa fa-check"></i><b>13.3</b> Fitting a Linear Model</a></li>
<li class="chapter" data-level="13.4" data-path="linear-regression.html"><a href="linear-regression.html#multiple-regression"><i class="fa fa-check"></i><b>13.4</b> Multiple Regression</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html"><i class="fa fa-check"></i><b>14</b> Analysis of Variance</a><ul>
<li class="chapter" data-level="14.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#one-sample-hypotheses"><i class="fa fa-check"></i><b>14.1</b> One Sample Hypotheses</a><ul>
<li class="chapter" data-level="14.1.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#data-variability"><i class="fa fa-check"></i><b>14.1.1</b> Data Variability</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#two-sample-hypotheses"><i class="fa fa-check"></i><b>14.2</b> Two Sample Hypotheses</a></li>
<li class="chapter" data-level="14.3" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#many-sample-hypotheses"><i class="fa fa-check"></i><b>14.3</b> Many Sample Hypotheses</a><ul>
<li class="chapter" data-level="14.3.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#post-hoc-tests"><i class="fa fa-check"></i><b>14.3.1</b> Post-Hoc Tests</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="http://dyerlab.org" target="blank">the Dyer Laboratory</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Environmental Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear-regression" class="section level1">
<h1><span class="header-section-number">13</span> Linear Regression</h1>
<blockquote>
<p>In this activity, we explore the concepts of model development using regression. Here we show how to create a model, extract parameters from the model, and evaluate the appropriateness of the model.</p>
</blockquote>
<div id="the-data-1" class="section level2">
<h2><span class="header-section-number">13.1</span> The Data</h2>
<p>For this exercise, we will play with some different data. In this case, we will use some data that is in the <code>MASS</code> package describing 1993 vehicles.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(MASS)
<span class="kw">names</span>(Cars93)</code></pre></div>
<pre><code>##  [1] &quot;Manufacturer&quot;       &quot;Model&quot;              &quot;Type&quot;              
##  [4] &quot;Min.Price&quot;          &quot;Price&quot;              &quot;Max.Price&quot;         
##  [7] &quot;MPG.city&quot;           &quot;MPG.highway&quot;        &quot;AirBags&quot;           
## [10] &quot;DriveTrain&quot;         &quot;Cylinders&quot;          &quot;EngineSize&quot;        
## [13] &quot;Horsepower&quot;         &quot;RPM&quot;                &quot;Rev.per.mile&quot;      
## [16] &quot;Man.trans.avail&quot;    &quot;Fuel.tank.capacity&quot; &quot;Passengers&quot;        
## [19] &quot;Length&quot;             &quot;Wheelbase&quot;          &quot;Width&quot;             
## [22] &quot;Turn.circle&quot;        &quot;Rear.seat.room&quot;     &quot;Luggage.room&quot;      
## [25] &quot;Weight&quot;             &quot;Origin&quot;             &quot;Make&quot;</code></pre>
<p>These data were taken from Car and Driver in 1993 and contain information on 93 different models that were produced that year. For our</p>
</div>
<div id="least-squares-linear-regression" class="section level2">
<h2><span class="header-section-number">13.2</span> Least Squares Linear Regression</h2>
<p>If both your predictor and response data are <code>numeric</code> and you are attempting to create a mathematical representation of one variable in terms of the other, a regression approach is appropriate. The simplest model, containing one predictor and one response variable can be written as:</p>
<p><span class="math display">\[
y_{ij} = \beta_0 + \beta_1x_i + \epsilon_j
\]</span></p>
<p>Where <span class="math inline">\(y_{ij}\)</span> is the observed value, <span class="math inline">\(\beta_0\)</span> is the intercept term (where the line crosses the y-axis), <span class="math inline">\(\beta_1\)</span> is the slope coefficient on the <span class="math inline">\(x_1\)</span> variable, and <span class="math inline">\(\epsilon_j\)</span> is the error term–what is not explained by the model.</p>
<p>Least Squares Linear Regression is perhaps the most commonly used method to estimate a regression model and it is the one that is implemented in the functions below. To estimate the model, it follows the basic steps (illustrated in the figure below).</p>
<ol style="list-style-type: decimal">
<li>The regression model will fit a line consisting of points we will call <span class="math inline">\(\hat{y}\)</span>.</li>
<li>This line will go through the mean of both the x- and y- data points (<span class="math inline">\(\bar{x}\)</span> and <span class="math inline">\(\bar{y}\)</span> respectively).</li>
<li>The slope of the line, anchored at <span class="math inline">\((\bar{x}, \bar{y})\)</span>, will be determined by finding a regression coefficient, <span class="math inline">\(\beta_1\)</span>, that minimizes the sum of the distances between each observed value and its corresponding fitted value (e.g., select a <span class="math inline">\(\beta_1\)</span> that makes the smallest <span class="math inline">\(\sum (y_i - \hat{y}_i)^2\)</span>).</li>
<li>Estimate <span class="math inline">\(\beta_0\)</span> the equation above using <span class="math inline">\(\beta_1\)</span> while inserting <span class="math inline">\(\bar{y}\)</span> and <span class="math inline">\(\bar{x}\)</span> for the response and predictor variables.</li>
</ol>
<div class="figure">
<img src="LeastSquaresRegression.png" alt="Least squares regression fitting." />
<p class="caption">Least squares regression fitting.</p>
</div>
<p>It is a rather simple approach and one that is expandable across a broad range of conditions. However, there are some assumptions that need to be met when using a least squares linear regression. These include:</p>
<ol style="list-style-type: decimal">
<li><em>A linear relationship.</em> The terms we used above are specifically linear (e.g., there are no higher order exponents on any of the values). If you suspect that there is a non-linear relationship between the variables, you can explore models that use modifications of the original data (e.g., <span class="math inline">\(\sqrt{y}\)</span>, <span class="math inline">\(x^3\)</span>, etc.).</li>
<li><em>Normality of the data</em>. As we saw earlier in the semester, we need to make certain assumptions about the underlying form of the data we are working with. In this case, we will be assuming that the data we are working with conform to normal expectations. You should test that <em>a priori</em> and we will see a bit later how it can be examined in the variation in the response not described by the model (e.g., the <span class="math inline">\(\epsilon\)</span> in the equation above).</li>
<li><em>Homoscedasticity</em>. Scedasticity measures the variation in a variable throughout its range. It is important for us to look to make sure that the variation in our response variable is roughly uniform across its range (homoscedastic) as opposed to having a lot of variation on one end and little on the other (a condition of heteroscedasticity).</li>
<li><em>No autocorrelation</em>. For ecological data, this is an important component. If we are collecting data, the spatial proximity of where we collect the data should not contribute to similarity in the response variable.<br />
</li>
<li><em>No colinearity among predictors</em>. If you are fitting a model with more than one predictor variable, they should not be co-linear. What does this mean? It means that you should not use predictor variables that are highly correlated. How high? Well, one thought is that if <span class="math inline">\(1-R^2 &lt; 0.2\)</span> you may need to be concerned (where <span class="math inline">\(R^2\)</span> is the fraction of the variation you can explain in one predictor by another using a linear regression approximation).</li>
</ol>
</div>
<div id="fitting-a-linear-model" class="section level2">
<h2><span class="header-section-number">13.3</span> Fitting a Linear Model</h2>
<p>To fit a model in R, we use the function <code>lm()</code> (literally short of ‘linear model’) and specify the formula we are trying to fit. In the following example, we will be looking to see the extent to which we can predict horsepower as a function of engine size.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
p &lt;-<span class="st"> </span><span class="kw">ggplot</span>( Cars93, <span class="kw">aes</span>(<span class="dt">x=</span>EngineSize, <span class="dt">y=</span>Horsepower) ) +<span class="st"> </span><span class="kw">geom_point</span>() 
p +<span class="st"> </span><span class="kw">geom_text</span>( <span class="kw">aes</span>(<span class="dt">label=</span>Make, <span class="dt">y=</span>Horsepower<span class="dv">+10</span>), <span class="dt">data=</span>Cars93[<span class="dv">57</span>,])</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-211"></span>
<img src="Applied_Environmental_Statistics_files/figure-html/unnamed-chunk-211-1.png" alt="Horsepower as a function of engine size (in Liters) for 93 different vehicles available in 1993.  The Mazda RX-7 is labeled as it is a rotary engine, an entirely different kind of engine than the rest." width="576" />
<p class="caption">
Figure 13.1: Horsepower as a function of engine size (in Liters) for 93 different vehicles available in 1993. The Mazda RX-7 is labeled as it is a rotary engine, an entirely different kind of engine than the rest.
</p>
</div>
<p>As such, we specify the formula</p>
<p><code>Horsepower ~ EngineSize</code></p>
<p>which means, literally, that Horsepower is a function of EngineSize.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit &lt;-<span class="st"> </span><span class="kw">lm</span>( Horsepower ~<span class="st"> </span>EngineSize, <span class="dt">data=</span>Cars93)
fit</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Horsepower ~ EngineSize, data = Cars93)
## 
## Coefficients:
## (Intercept)   EngineSize  
##       45.22        36.96</code></pre>
<p>The interesting terms here are the intercept (<span class="math inline">\(\beta_0\)</span>) and the coefficient (the <span class="math inline">\(\beta_1\)</span>) for the model fitting <em>Horsepower</em> to <em>EngineSize</em>.</p>
<p>As we saw previously in the case of a <code>cor.test()</code> examples, the thing that is returned from a <code>lm()</code> function call is a specific type of R object (it is really just a list),</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(fit)</code></pre></div>
<pre><code>## [1] &quot;lm&quot;</code></pre>
<p>one with specific names and terms contained within it.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(fit)</code></pre></div>
<pre><code>##  [1] &quot;coefficients&quot;  &quot;residuals&quot;     &quot;effects&quot;       &quot;rank&quot;         
##  [5] &quot;fitted.values&quot; &quot;assign&quot;        &quot;qr&quot;            &quot;df.residual&quot;  
##  [9] &quot;xlevels&quot;       &quot;call&quot;          &quot;terms&quot;         &quot;model&quot;</code></pre>
<p>As before, we can use this to make a plot of the model and the data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>( Horsepower ~<span class="st"> </span>EngineSize, <span class="dt">data=</span>Cars93, <span class="dt">xlab =</span><span class="st">&quot;Engine Size (Liters)&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Horsepower&quot;</span> )
<span class="kw">abline</span>(<span class="dt">a=</span>fit$coefficients[<span class="dv">1</span>], <span class="dt">b=</span>fit$coefficients[<span class="dv">2</span>], <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)
b0 &lt;-<span class="st"> </span><span class="kw">format</span>( fit$coefficients[<span class="dv">1</span>], <span class="dt">digits=</span><span class="dv">3</span>)
b1 &lt;-<span class="st"> </span><span class="kw">format</span>( fit$coefficients[<span class="dv">2</span>], <span class="dt">digits=</span><span class="dv">3</span>)
msg &lt;-<span class="st"> </span><span class="kw">paste</span>( <span class="st">&quot;y = &quot;</span>,b0, <span class="st">&quot; + &quot;</span>, b1, <span class="st">&quot;x&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)
<span class="kw">text</span>( <span class="fl">4.5</span>,<span class="dv">100</span>, msg)</code></pre></div>
<p><img src="Applied_Environmental_Statistics_files/figure-html/unnamed-chunk-215-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>How does the model look? Do you think it is a good fit? Lets look at some output of the <code>lm</code> object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(fit)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Horsepower ~ EngineSize, data = Cars93)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -75.910 -19.664  -9.146  15.247 161.728 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   45.219     10.312   4.385 3.11e-05 ***
## EngineSize    36.963      3.605  10.253  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 35.87 on 91 degrees of freedom
## Multiple R-squared:  0.536,  Adjusted R-squared:  0.5309 
## F-statistic: 105.1 on 1 and 91 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>We see the terms, an estimate of their magnitude, and associated probability of keeping them in the model (assuming they are not zero). In the middle of the output, we see the R-squared values.</p>
<p><span class="math display">\[
R^2 = \frac{SS_{Model}}{SS_{Total}}
\]</span></p>
<p>which tells us what fraction of the variation in the response variable is actually explained by the model. A higher value for <span class="math inline">\(R^2\)</span> means that we are explaining more of the overall variation, whereas a smaller value means less of the variance is being explained. There is a caveat here, the magnitude of <span class="math inline">\(R^2\)</span> will increase as we add more predictor variables. To get around this, we can look at an adjusted-<span class="math inline">\(R^2\)</span>, one that is corrected by the number of terms we have in the model. The formula for that is:</p>
<p><span class="math display">\[
R^2_{Adj} = R^2 - (1-R^2)\frac{p}{N-p-1}
\]</span></p>
<p>where <span class="math inline">\(R^2\)</span> is as above, <span class="math inline">\(p\)</span> is the number of terms in the model, and <span class="math inline">\(N\)</span> is the number of observations.</p>
<p>In the lower part of the output, we see the estimated <span class="math inline">\(F\)</span> statistic, the degrees of freedom, and the associated P-Value. The <span class="math inline">\(F\)</span> statistic is the test statistic for the model and is defined as the ratio of the variation explained by the model to that of the underlying data. The more variation explained, the larger the <span class="math inline">\(F\)</span> statistic and the less likely that the model should be rejected.</p>
<p>For a look at the classic ANOVA table, we see the degrees of freedom, the Sums of Squares, the Mean Squares and the estimate <span class="math inline">\(F\)</span> statistic.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(fit)</code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: Horsepower
##            Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## EngineSize  1 135267  135267  105.12 &lt; 2.2e-16 ***
## Residuals  91 117097    1287                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The degrees of freedom are assigned as follows:</p>
<ol style="list-style-type: decimal">
<li>The total degrees of freedom is <span class="math inline">\(N-1\)</span>.</li>
<li>You allocate a degree of freedom for each predictor variable.</li>
<li>The residual degrees of freedom (e.g. that which we did not explain) is the the rest (e.g., <span class="math inline">\(N - p - 1\)</span>).</li>
</ol>
<p>The terms for the sums of squares come from the underlying data in the following way. The total sums of squared deviations are defined as:</p>
<p><span class="math display">\[
SS_{Total} = \sum_{i=1}^N (y_i - \bar{y})^2
\]</span></p>
<p>which are composed of the model sums of squares (the variation in the response explained by the model)</p>
<p><span class="math display">\[
SS_{Model} = \sum_{i=1}^N (\hat{y}_i - \bar{y})^2
\]</span></p>
<p>and the residual (sometimes called error) variation</p>
<p><span class="math display">\[
SS_{Residual} = \sum{i=1}^N (y - \hat{y}_i)^2
\]</span></p>
<p>These values denote the fit of the underlying model to the data, however, they are influenced by the number of samples that were collected. To estimate the mean deviation in the sums of squares, a set of parameters called the Mean Squares, you divide each of the sums of squares by its degrees of freedom.</p>
<span class="math display">\[\begin{align*}
MS_{Model} &amp;= \frac{SS_{Model}}{df_{Model}} \\
MS_{Residual} &amp;= \frac{SS_{Residual}}{df_{Residual}} \\
MS_{Total} &amp;= \frac{SS_{Total}}{df_{Total}} 
\end{align*}\]</span>
<p>The <span class="math inline">\(MS_{Residual}\)</span> term is our best estimator of the underlying variation in the model, whereas the <span class="math inline">\(MS_{Model}\)</span> is the variation associated with fitting the model. The ratio of these two terms create the test statistic, <span class="math inline">\(F\)</span>.</p>
<p><span class="math display">\[
F = \frac{MS_{Model}}{MS_{Residual}}
\]</span></p>
<p>This test-statistic, a ratio of variances, has a well known distribution IF the underlying data are normal. As this is well characterized, we can look up the probability of observing a value of this statistic as large or larger than that observed. To do this, we must know the degrees of freedom—more <span class="math inline">\(df\)</span> means larger <span class="math inline">\(F\)</span> and we need to take this into account.</p>
<p>The expected value of <span class="math inline">\(F\)</span> at <span class="math inline">\(x\)</span> is defined as:</p>
<p><span class="math display">\[
F_{x,df_1,df_2} = \frac{\sqrt{\frac{(df_1x)^{df_1}df_2^{df_2}}{(df_1x+df_2)^{df_1+df_2}}}}{x\mathbf{B}\left(\frac{df_1}{2},\frac{df2}{2}\right)}
\]</span></p>
<p>where <span class="math inline">\(df_1\)</span> and <span class="math inline">\(df_2\)</span> are the model and error degrees of freedom and <span class="math inline">\(\mathbf{B}\)</span> is the beta function.</p>
<p>So the model ‘looks’ like it is one that explains a lot of the variation, (<span class="math inline">\(R^2 =\)</span> 0.5309), the amount of which appears to be of a magnitude that suggests the null hypothesis, <span class="math inline">\(H_O: \beta_1 = 0\)</span> is not true (e.g., <span class="math inline">\(P &lt; 2.2e-16\)</span>). But is it a model that fits the assumptions and is well behaved? We can absolutely have significant models that whose underlying data are not consistent with the assumptions.</p>
<p>Fortunately, the <code>lm()</code> object has some built-in plotting options that help us to diagnose the appropriateness of the model.</p>
<p>If you type <code>plot(fit)</code> you will be led through a series of plots depicted in the next figure.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))
<span class="kw">plot</span>(fit, <span class="dt">which=</span><span class="dv">1</span>)
<span class="kw">plot</span>(fit, <span class="dt">which=</span><span class="dv">2</span>)
<span class="kw">plot</span>(fit, <span class="dt">which=</span><span class="dv">3</span>)
<span class="kw">plot</span>(fit, <span class="dt">which=</span><span class="dv">5</span>)</code></pre></div>
<p><img src="Applied_Environmental_Statistics_files/figure-html/unnamed-chunk-218-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>These depict the following items.</p>
<ol style="list-style-type: decimal">
<li><em>Residuals vs. Fitted</em> - This gives an indication of what is not explained by the model. Here if there are general trends (e.g., the residuals show systematic patterns of increase, decrease or non-linearity) these depict variance that is not explained by the underlying model.<br />
</li>
<li><em>Residuals QQPlot</em> - The variation that is not explained should also be normal, if it deviates from normality this suggests that the assumptions of the error terms may not be met in the underlying model.</li>
<li><em>Scale-Location</em> - A measure that removes any skew in the expected values.</li>
<li><em>Leverage</em> - A measure of the amount of differential influence that individual points may have in the estimation of the</li>
</ol>
<p>You must always check these values for validity in the underlying model.</p>
</div>
<div id="multiple-regression" class="section level2">
<h2><span class="header-section-number">13.4</span> Multiple Regression</h2>
<p>What if we have several potential predictor variables that we may want to put into a model? How can we determine which should be added to the model and which should not?</p>
<p>In this example, I’m going to take vehicle weight and see if it is predicted by</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">lm</span>( Weight ~<span class="st"> </span>Length, <span class="dt">data=</span>Cars93)
fit<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">lm</span>( Weight ~<span class="st"> </span>Width, <span class="dt">data=</span>Cars93)
fit<span class="fl">.3</span> &lt;-<span class="st"> </span><span class="kw">lm</span>( Weight ~<span class="st"> </span>EngineSize, <span class="dt">data=</span>Cars93)
fit<span class="fl">.4</span> &lt;-<span class="st"> </span><span class="kw">lm</span>( Weight ~<span class="st"> </span>Fuel.tank.capacity, <span class="dt">data=</span>Cars93)
fit<span class="fl">.5</span> &lt;-<span class="st"> </span><span class="kw">lm</span>( Weight ~<span class="st"> </span>Length +<span class="st"> </span>Width, <span class="dt">data=</span>Cars93)
fit<span class="fl">.6</span> &lt;-<span class="st"> </span><span class="kw">lm</span>( Weight ~<span class="st"> </span>Width +<span class="st"> </span>Fuel.tank.capacity, <span class="dt">data=</span>Cars93)
fit<span class="fl">.7</span> &lt;-<span class="st"> </span><span class="kw">lm</span>( Weight ~<span class="st"> </span>Length +<span class="st"> </span>EngineSize, <span class="dt">data=</span>Cars93)
fit<span class="fl">.8</span> &lt;-<span class="st"> </span><span class="kw">lm</span>( Weight ~<span class="st"> </span>Length +<span class="st"> </span>Fuel.tank.capacity, <span class="dt">data=</span>Cars93)</code></pre></div>
<p>So how do we determine which of these model is better? Look at the output from each, which do you think?</p>
<p>One way we could evaluate them is to look at the a</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">R2 &lt;-<span class="st"> </span><span class="kw">c</span>( <span class="kw">summary</span>(fit<span class="fl">.1</span>)$r.squared, 
         <span class="kw">summary</span>(fit<span class="fl">.2</span>)$r.squared,
         <span class="kw">summary</span>(fit<span class="fl">.3</span>)$r.squared,
         <span class="kw">summary</span>(fit<span class="fl">.4</span>)$r.squared,
         <span class="kw">summary</span>(fit<span class="fl">.5</span>)$r.squared,
         <span class="kw">summary</span>(fit<span class="fl">.6</span>)$r.squared,
         <span class="kw">summary</span>(fit<span class="fl">.7</span>)$r.squared,
         <span class="kw">summary</span>(fit<span class="fl">.8</span>)$r.squared)
<span class="kw">names</span>(R2) &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;fit&quot;</span>,<span class="dv">1</span>:<span class="dv">8</span>, <span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)
R2</code></pre></div>
<pre><code>##     fit.1     fit.2     fit.3     fit.4     fit.5     fit.6     fit.7 
## 0.6500782 0.7655560 0.7141523 0.7992683 0.7888728 0.8707672 0.7693030 
##     fit.8 
## 0.8675266</code></pre>
<p>Another way to evaluate different models is through the use of a measure such as AIC (Akaike’s Information Criteria) or relatives. The notion of these parameters is that there needs to be a price paid for adding additional terms to a model. It is possible for one to add additional predictor variables and eventually inflate the observed <span class="math inline">\(R^2\)</span> for the model. You can even add random variables and see the same thing, they will incrementally account for small amounts of variation in the response variable. AIC is defined as:</p>
<p><span class="math display">\[
AIC = 2k - 2\log(L)
\]</span></p>
<p>where <span class="math inline">\(k\)</span> is the number of terms in the model and <span class="math inline">\(L\)</span> is an estimate of the log Likelihood estimator of the model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">aic.vals &lt;-<span class="st"> </span><span class="kw">c</span>( <span class="kw">AIC</span>(fit<span class="fl">.1</span>), <span class="kw">AIC</span>(fit<span class="fl">.2</span>), 
               <span class="kw">AIC</span>(fit<span class="fl">.3</span>), <span class="kw">AIC</span>(fit<span class="fl">.4</span>), 
               <span class="kw">AIC</span>(fit<span class="fl">.5</span>), <span class="kw">AIC</span>(fit<span class="fl">.6</span>), 
               <span class="kw">AIC</span>(fit<span class="fl">.7</span>), <span class="kw">AIC</span>(fit<span class="fl">.8</span>) )
<span class="kw">names</span>(aic.vals) &lt;-<span class="st"> </span><span class="kw">names</span>(R2)
aic.vals</code></pre></div>
<pre><code>##    fit.1    fit.2    fit.3    fit.4    fit.5    fit.6    fit.7    fit.8 
## 1357.933 1320.687 1339.124 1306.249 1312.945 1267.296 1321.189 1269.600</code></pre>
<p>The better models are those with the smallest AIC values. They may be positive or negative but the smallest ones are considered to be models that are better fit. How much of a difference is considered smaller? Well, the general approach is to estimate <span class="math inline">\(\delta_{AIC}\)</span> as the difference in magnitude of the alternative AIC values from the smallest one</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dAIC &lt;-<span class="st"> </span>(aic.vals -<span class="st"> </span><span class="kw">min</span>( aic.vals ))
dAIC</code></pre></div>
<pre><code>##     fit.1     fit.2     fit.3     fit.4     fit.5     fit.6     fit.7 
## 90.636733 53.390921 71.827437 38.952887 45.648586  0.000000 53.892522 
##     fit.8 
##  2.303289</code></pre>
<p>General consensus is that <span class="math inline">\(\delta_{AIC}\)</span> values that are between 0-2 are small enough that the models are indistinguishable—they should all be considered as equally informative. Values of <span class="math inline">\(\delta_{AIC}\)</span> between 3-5 suggest that the models are pretty close and you may want to explore them further. Values greater than 5 suggest that those models are not as good as the one with the smallest AIC.</p>
<p>Here is a more readable output from these model tests.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Models &lt;-<span class="st"> </span><span class="kw">as.character</span>( <span class="kw">c</span>( <span class="kw">formula</span>(fit<span class="fl">.1</span>$terms),
             <span class="kw">formula</span>(fit<span class="fl">.2</span>$terms),
             <span class="kw">formula</span>(fit<span class="fl">.3</span>$terms),
             <span class="kw">formula</span>(fit<span class="fl">.4</span>$terms),
             <span class="kw">formula</span>(fit<span class="fl">.5</span>$terms),
             <span class="kw">formula</span>(fit<span class="fl">.6</span>$terms),
             <span class="kw">formula</span>(fit<span class="fl">.7</span>$terms),
             <span class="kw">formula</span>(fit<span class="fl">.8</span>$terms)))
df &lt;-<span class="st"> </span><span class="kw">data.frame</span>( <span class="dt">Model=</span><span class="kw">names</span>(dAIC),
                  <span class="dt">Terms=</span>Models,
                  <span class="dt">R2=</span>R2,
                  <span class="dt">AIC=</span>aic.vals,
                  <span class="dt">Delta.AIC=</span>dAIC)
knitr::<span class="kw">kable</span>(df, <span class="dt">row.names =</span> <span class="ot">FALSE</span>,<span class="dt">digits =</span> <span class="dv">3</span>)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="left">Terms</th>
<th align="right">R2</th>
<th align="right">AIC</th>
<th align="right">Delta.AIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">fit.1</td>
<td align="left">Weight ~ Length</td>
<td align="right">0.650</td>
<td align="right">1357.933</td>
<td align="right">90.637</td>
</tr>
<tr class="even">
<td align="left">fit.2</td>
<td align="left">Weight ~ Width</td>
<td align="right">0.766</td>
<td align="right">1320.687</td>
<td align="right">53.391</td>
</tr>
<tr class="odd">
<td align="left">fit.3</td>
<td align="left">Weight ~ EngineSize</td>
<td align="right">0.714</td>
<td align="right">1339.124</td>
<td align="right">71.827</td>
</tr>
<tr class="even">
<td align="left">fit.4</td>
<td align="left">Weight ~ Fuel.tank.capacity</td>
<td align="right">0.799</td>
<td align="right">1306.249</td>
<td align="right">38.953</td>
</tr>
<tr class="odd">
<td align="left">fit.5</td>
<td align="left">Weight ~ Length + Width</td>
<td align="right">0.789</td>
<td align="right">1312.945</td>
<td align="right">45.649</td>
</tr>
<tr class="even">
<td align="left">fit.6</td>
<td align="left">Weight ~ Width + Fuel.tank.capacity</td>
<td align="right">0.871</td>
<td align="right">1267.296</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="left">fit.7</td>
<td align="left">Weight ~ Length + EngineSize</td>
<td align="right">0.769</td>
<td align="right">1321.189</td>
<td align="right">53.893</td>
</tr>
<tr class="even">
<td align="left">fit.8</td>
<td align="left">Weight ~ Length + Fuel.tank.capacity</td>
<td align="right">0.868</td>
<td align="right">1269.600</td>
<td align="right">2.303</td>
</tr>
</tbody>
</table>
<p>It appears that both models <code>fit.6</code> and <code>fit.8</code>, the two models with the size of the fuel tank, do a pretty reasonable job of describing the weight of the cars. Strictly speaking <code>fit.6</code> is probably the most explanatory of the models with <code>fit.8</code> being pretty close.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="correlation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="analysis-of-variance.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"],
"instapaper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
